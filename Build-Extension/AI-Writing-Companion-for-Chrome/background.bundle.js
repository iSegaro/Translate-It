(()=>{var e={1771:(e,t,r)=>{"use strict";r.d(t,{x:()=>n});var n=[{name:"English",voiceCode:"en-US",promptName:"English",code:"en",locale:"en",flag:"ðŸ‡¬ðŸ‡§"},{name:"Farsi",voiceCode:"fa-IR",promptName:"Farsi",code:"fa",locale:"fa",flag:"ðŸ‡®ðŸ‡·"},{name:"German",voiceCode:"de-DE",promptName:"German",code:"de"},{name:"French",voiceCode:"fr-FR",promptName:"French",code:"fr"},{name:"Chinese (Simplified)",voiceCode:"zh-CN",promptName:"Chinese (Simplified)",code:"zh"},{name:"Spanish",voiceCode:"es-ES",promptName:"Spanish",code:"es"},{name:"Hindi",voiceCode:"hi-IN",promptName:"Hindi",code:"hi"},{name:"Arabic",voiceCode:"ar-SA",promptName:"Arabic",code:"ar"},{name:"Bengali",voiceCode:"bn-BD",promptName:"Bengali",code:"bn"},{name:"Portuguese",voiceCode:"pt-PT",promptName:"Portuguese",code:"pt"},{name:"Russian",voiceCode:"ru-RU",promptName:"Russian",code:"ru"},{name:"Japanese",voiceCode:"ja-JP",promptName:"Japanese",code:"ja"},{name:"Urdu",voiceCode:"ur-PK",promptName:"Urdu",code:"ur"},{name:"Indonesian",voiceCode:"id-ID",promptName:"Indonesian",code:"id"},{name:"Italian",voiceCode:"it-IT",promptName:"Italian",code:"it"},{name:"Swahili",voiceCode:"sw-KE",promptName:"Swahili",code:"sw"},{name:"Marathi",voiceCode:"mr-IN",promptName:"Marathi",code:"mr"},{name:"Telugu",voiceCode:"te-IN",promptName:"Telugu",code:"te"},{name:"Tamil",voiceCode:"ta-IN",promptName:"Tamil",code:"ta"},{name:"Turkish",voiceCode:"tr-TR",promptName:"Turkish",code:"tr"},{name:"Vietnamese",voiceCode:"vi-VN",promptName:"Vietnamese",code:"vi"},{name:"Korean",voiceCode:"ko-KR",promptName:"Korean",code:"ko"},{name:"Thai",voiceCode:"th-TH",promptName:"Thai",code:"th"},{name:"Malay",voiceCode:"ms-MY",promptName:"Malay",code:"ms"},{name:"Polish",voiceCode:"pl-PL",promptName:"Polish",code:"pl"},{name:"Dutch",voiceCode:"nl-NL",promptName:"Dutch",code:"nl"},{name:"Filipino",voiceCode:"fil-PH",promptName:"Filipino",code:"fi"},{name:"Ukrainian",voiceCode:"uk-UA",promptName:"Ukrainian",code:"uk"},{name:"Romanian",voiceCode:"ro-RO",promptName:"Romanian",code:"ro"},{name:"Greek",voiceCode:"el-GR",promptName:"Greek",code:"el"},{name:"Czech",voiceCode:"cs-CZ",promptName:"Czech",code:"cs"},{name:"Hungarian",voiceCode:"hu-HU",promptName:"Hungarian",code:"hu"},{name:"Swedish",voiceCode:"sv-SE",promptName:"Swedish",code:"sv"},{name:"Norwegian",voiceCode:"no-NO",promptName:"Norwegian",code:"no"},{name:"Danish",voiceCode:"da-DK",promptName:"Danish",code:"da"},{name:"Finnish",voiceCode:"fi-FI",promptName:"Finnish",code:"fi"},{name:"Hebrew",voiceCode:"he-IL",promptName:"Hebrew",code:"he"},{name:"Afrikaans",voiceCode:"af-ZA",promptName:"Afrikaans",code:"af"},{name:"Albanian",voiceCode:"sq-AL",promptName:"Albanian",code:"sq"},{name:"Bulgarian",voiceCode:"bg-BG",promptName:"Bulgarian",code:"bg"},{name:"Catalan",voiceCode:"ca-ES",promptName:"Catalan",code:"ca"},{name:"Croatian",voiceCode:"hr-HR",promptName:"Croatian",code:"hr"},{name:"Estonian",voiceCode:"et-EE",promptName:"Estonian",code:"et"},{name:"Latvian",voiceCode:"lv-LV",promptName:"Latvian",code:"lv"},{name:"Lithuanian",voiceCode:"lt-LT",promptName:"Lithuanian",code:"lt"},{name:"Slovak",voiceCode:"sk-SK",promptName:"Slovak",code:"sk"},{name:"Slovenian",voiceCode:"sl-SI",promptName:"Slovenian",code:"sl"},{name:"Serbian",voiceCode:"sr-RS",promptName:"Serbian",code:"sr"},{name:"Malayalam",voiceCode:"ml-IN",promptName:"Malayalam",code:"ml"},{name:"Kannada",voiceCode:"kn-IN",promptName:"Kannada",code:"kn"},{name:"Odia",voiceCode:"or-IN",promptName:"Odia",code:"or"},{name:"Punjabi",voiceCode:"pa-IN",promptName:"Punjabi",code:"pa"},{name:"Sinhala",voiceCode:"si-LK",promptName:"Sinhala",code:"si"},{name:"Nepali",voiceCode:"ne-NP",promptName:"Nepali",code:"ne"},{name:"Azerbaijani",voiceCode:"az-AZ",promptName:"Azerbaijani",code:"az"},{name:"Belarusian",voiceCode:"be-BY",promptName:"Belarusian",code:"be"},{name:"Kazakh",voiceCode:"kk-KZ",promptName:"Kazakh",code:"kk"},{name:"Uzbek",voiceCode:"uz-UZ",promptName:"Uzbek",code:"uz"},{name:"Pashto",voiceCode:"ps-AF",promptName:"Pashto",code:"ps"},{name:"Tagalog",voiceCode:"tl-PH",promptName:"Tagalog",code:"tl"},{name:"Cebuano",voiceCode:"en-US",promptName:"Cebuano",code:"en"}]},4385:(e,t,r)=>{"use strict";r.d(t,{Ig:()=>openOptionsPage,cb:()=>c,hA:()=>isExtensionContextValid,tb:()=>logME});var n=r(63675),o=r.n(n),a=r(51318),i=(r(25980),r(50354)),c=(new a.z,function(e){return new Promise((function(t){return setTimeout(t,e)}))});var u,logME=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];(0,i.Ij)().then((function(e){var r;e&&(r=console).debug.apply(r,t)}))},isExtensionContextValid=function(){try{var e,t;return!(null===o()||void 0===o()||null===(e=o().runtime)||void 0===e||!e.id||null===o()||void 0===o()||null===(t=o().storage)||void 0===t||!t.local)}catch(e){return!1}},openOptionsPage=function(){o().runtime.openOptionsPage?o().runtime.openOptionsPage():window.open(o().runtime.getURL("html/options.html"))};u=null},4446:(e,t,r)=>{"use strict";r.d(t,{bQ:()=>getTranslationString});var n=r(63675),o=r.n(n),a=(r(10870),r(50354)),i=r(1771);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}var c=new Map;function loadTranslationsForLanguageCached(e){return _loadTranslationsForLanguageCached.apply(this,arguments)}function _loadTranslationsForLanguageCached(){return(_loadTranslationsForLanguageCached=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(e){var t,r,n;return _regeneratorRuntime().wrap((function(a){for(;1;)switch(a.prev=a.next){case 0:if(!c.has(e)){a.next=2;break}return a.abrupt("return",c.get(e));case 2:return a.prev=2,t=o().runtime.getURL("_locales/".concat(e,"/messages.json")),a.next=6,fetch(t);case 6:if((r=a.sent).ok){a.next=9;break}return a.abrupt("return",null);case 9:return a.next=11,r.json();case 11:return n=a.sent,c.set(e,n),a.abrupt("return",n);case 16:return a.prev=16,a.t0=a["catch"](2),a.abrupt("return",null);case 19:case"end":return a.stop()}}),_callee,null,[[2,16]])})))).apply(this,arguments)}function getTranslationString(e,t){return _getTranslationString.apply(this,arguments)}function _getTranslationString(){return(_getTranslationString=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(e,t){var r,n,o,c,u;return _regeneratorRuntime().wrap((function(s){for(;1;)switch(s.prev=s.next){case 0:if((n=t)&&2===n.length){s.next=7;break}return s.next=4,(0,a.jz)();case 4:o=s.sent,c=i.x.find((function(e){return e.name===o||e.locale===o})),n=(null==c?void 0:c.code)||(2===(null==o?void 0:o.length)?o:"en");case 7:return s.next=9,loadTranslationsForLanguageCached(n);case 9:if(!(u=s.sent)||null===(r=u[e])||void 0===r||!r.message){s.next=12;break}return s.abrupt("return",u[e].message);case 12:return s.abrupt("return",null);case 13:case"end":return s.stop()}}),_callee2)})))).apply(this,arguments)}},5266:(e,t,r)=>{"use strict";r.r(t);var n=r(63675),o=r.n(n),a=r(4385);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,F=function(){};return{s:F,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(i)throw o}}}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}o().runtime.onStartup.addListener((function(){o().tabs.query({url:"<all_urls>"}).then(function(){var e,t=(e=_regeneratorRuntime().mark((function _callee(e){var t,r,n;return _regeneratorRuntime().wrap((function(i){for(;1;)switch(i.prev=i.next){case 0:return i.next=2,o().storage.local.get("EXTENSION_ENABLED");case 2:if(i.sent.EXTENSION_ENABLED){i.next=5;break}return i.abrupt("return");case 5:t=_createForOfIteratorHelper(e),i.prev=6,t.s();case 8:if((r=t.n()).done){i.next=22;break}if((n=r.value).id&&n.url){i.next=12;break}return i.abrupt("continue",20);case 12:return i.prev=12,i.next=15,o().runtime.sendMessage({action:"TRY_INJECT_IF_NEEDED",tabId:n.id,url:n.url});case 15:i.next=20;break;case 17:i.prev=17,i.t0=i["catch"](12),(0,a.tb)("[onStartup] sendMessage failed:",i.t0.message);case 20:i.next=8;break;case 22:i.next=27;break;case 24:i.prev=24,i.t1=i["catch"](6),t.e(i.t1);case 27:return i.prev=27,t.f(),i.finish(27);case 30:case"end":return i.stop()}}),_callee,null,[[6,24,27,30],[12,17]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))});return function(e){return t.apply(this,arguments)}}())}))},10870:(e,t,r)=>{"use strict";r.d(t,{FL:()=>detectTextLanguage,UK:()=>getLanguageInfoFromName,yM:()=>isPersianText});var n=r(63675),o=r.n(n),a=r(50354),i=r(1771);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,F=function(){};return{s:F,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(i)throw o}}}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}var isPersianText=function(e){return a.PI.PERSIAN_REGEX.test(e)};function detectTextLanguage(e){return _detectTextLanguage.apply(this,arguments)}function _detectTextLanguage(){var e;return e=_regeneratorRuntime().mark((function _callee(e){var t,r;return _regeneratorRuntime().wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,o().i18n.detectLanguage(e);case 3:if(!((t=n.sent)&&t.languages&&t.languages.length>0)){n.next=9;break}return r=t.languages[0].language,n.abrupt("return",r);case 9:return n.abrupt("return",null);case 10:n.next=15;break;case 12:return n.prev=12,n.t0=n["catch"](0),n.abrupt("return",null);case 15:case"end":return n.stop()}}),_callee,null,[[0,12]])})),_detectTextLanguage=function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))},_detectTextLanguage.apply(this,arguments)}function getLanguageInfoFromName(e){if(!e)return null;var t,r=e.toLowerCase(),n=_createForOfIteratorHelper(i.x);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.name.toLocaleLowerCase()===r)return o}}catch(e){n.e(e)}finally{n.f()}return null}},25980:(e,t,r)=>{"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=function(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_typeof(t)?t:t+""}r.d(t,{w:()=>n});var n=_createClass((function ErrorTypes(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ErrorTypes)}));_defineProperty(n,"API","API"),_defineProperty(n,"HTTP_ERROR","HTTP_ERROR"),_defineProperty(n,"NETWORK_ERROR","NETWORK_ERROR"),_defineProperty(n,"API_RESPONSE_INVALID","API_RESPONSE_INVALID"),_defineProperty(n,"SERVICE","SERVICE"),_defineProperty(n,"VALIDATION","VALIDATION"),_defineProperty(n,"TAB_AVAILABILITY","TAB"),_defineProperty(n,"CONTEXT","CONTEXT"),_defineProperty(n,"UI","UI"),_defineProperty(n,"INTEGRATION","INTEGRATION"),_defineProperty(n,"UNKNOWN","UNKNOWN"),_defineProperty(n,"PROMPT_INVALID","PROMPT_INVALID"),_defineProperty(n,"TEXT_EMPTY","TEXT_EMPTY"),_defineProperty(n,"TEXT_TOO_LONG","TEXT_TOO_LONG"),_defineProperty(n,"TRANSLATION_NOT_FOUND","TRANSLATION_NOT_FOUND"),_defineProperty(n,"TRANSLATION_FAILED","TRANSLATION_FAILED"),_defineProperty(n,"API_KEY_MISSING","API_KEY_MISSING"),_defineProperty(n,"API_KEY_INVALID","API_KEY_INVALID"),_defineProperty(n,"API_URL_MISSING","API_URL_MISSING"),_defineProperty(n,"MODEL_MISSING","MODEL_MISSING"),_defineProperty(n,"MODEL_OVERLOADED","MODEL_OVERLOADED"),_defineProperty(n,"QUOTA_EXCEEDED","QUOTA_EXCEEDED"),_defineProperty(n,"GEMINI_QUOTA_REGION","GEMINI_QUOTA_REGION")},48925:(e,t,r)=>{"use strict";r.d(t,{u1:()=>getErrorMessage});var n,o=r(4446),a=r(25980);function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _defineProperty(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_typeof(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n={},a.w.TEXT_EMPTY,"Text is empty"),a.w.PROMPT_INVALID,"Prompt is invalid"),a.w.TEXT_TOO_LONG,"Text is too long"),a.w.TRANSLATION_NOT_FOUND,"Translation not found"),a.w.TRANSLATION_FAILED,"Translation failed"),a.w.API,"API error"),a.w.API_KEY_MISSING,"API Key is missing"),a.w.API_KEY_INVALID,"API Key is wrong or invalid"),a.w.API_URL_MISSING,"API URL is missing"),a.w.MODEL_MISSING,"AI Model is missing or invalid"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,a.w.MODEL_OVERLOADED,"The Model is overloaded"),a.w.QUOTA_EXCEEDED,"You exceeded your current quota"),a.w.GEMINI_QUOTA_REGION,"You reached the Gemini quota. (Region issue)"),a.w.NETWORK_ERROR,"Connection to server failed"),a.w.HTTP_ERROR,"HTTP error"),a.w.CONTEXT,"Extension context lost"),a.w.UNKNOWN,"An unknown error occurred"),a.w.TAB_AVAILABILITY,"Tab not available"),a.w.UI,"User Interface error"),a.w.INTEGRATION,"Integration error"),_defineProperty(_defineProperty(n,a.w.SERVICE,"Service error"),a.w.VALIDATION,"Validation error"));function getErrorMessage(e){return _getErrorMessage.apply(this,arguments)}function _getErrorMessage(){var e;return e=_regeneratorRuntime().mark((function _callee(e){var t,r;return _regeneratorRuntime().wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:return t=e.startsWith("ERRORS_")?e:"ERRORS_".concat(e),n.next=3,(0,o.bQ)(t);case 3:return(r=n.sent)&&r.trim()||(r=i[e]||i[a.w.UNKNOWN]),n.abrupt("return",r);case 6:case"end":return n.stop()}}),_callee)})),_getErrorMessage=function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))},_getErrorMessage.apply(this,arguments)}},50354:(e,t,r)=>{"use strict";r.d(t,{A3:()=>m,A4:()=>j,Ce:()=>R,Ij:()=>w,M7:()=>b,M_:()=>s,OE:()=>M,PI:()=>i,YY:()=>x,ZL:()=>D,_2:()=>I,_r:()=>G,_u:()=>A,e7:()=>C,fz:()=>U,g6:()=>k,hL:()=>_,ie:()=>O,jz:()=>E,lB:()=>S,nC:()=>L,o7:()=>N,sR:()=>T,t3:()=>c,w1:()=>P});var n=r(63675),o=r.n(n),a=r(4385);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_typeof(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}var i={APP_NAME:"AI Writing Companion",USE_MOCK:!1,DEBUG_MODE:!1,EXTENSION_ENABLED:!0,APPLICATION_LOCALIZE:"Farsi",SOURCE_LANGUAGE:"English",TARGET_LANGUAGE:"Farsi",TRANSLATION_API:"gemini",API_URL:"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent",API_KEY:"",WEBAI_API_URL:"http://localhost:6969/translate",WEBAI_API_MODEL:"gemini-2.0-flash",OPENAI_API_KEY:"",OPENAI_API_URL:"https://api.openai.com/v1/chat/completions",OPENAI_API_MODEL:"gpt-3.5-turbo",OPENROUTER_API_KEY:"",OPENROUTER_API_URL:"https://openrouter.ai/api/v1/chat/completions",OPENROUTER_API_MODEL:"openai/gpt-3.5-turbo",TRANSLATE_ON_TEXT_FIELDS:!0,ENABLE_SHORTCUT_FOR_TEXT_FIELDS:!0,TRANSLATE_WITH_SELECT_ELEMENT:!0,TRANSLATE_ON_TEXT_SELECTION:!0,REQUIRE_CTRL_FOR_TEXT_SELECTION:!1,ENABLE_DICTIONARY:!0,HIGHTLIH_NEW_ELEMETN_RED:"2px solid red",TRANSLATION_ICON_TITLE:"Translate Text",HIGHLIGHT_STYLE:"2px solid red",ICON_TRANSLATION:"ðŸŒ",ICON_SUCCESS:"âœ… ",ICON_WARNING:"âš ï¸ ",ICON_STATUS:"â³ ",ICON_ERROR:"âŒ ",ICON_INFO:"ðŸ”µ ",ICON_REVERT:"â†©ï¸",NOTIFICATION_ALIGNMENT:"right",NOTIFICATION_TEXT_DIRECTION:"rtl",NOTIFICATION_TEXT_ALIGNMENT:"right",RTL_REGEX:/[\u0591-\u07FF\u0600-\u06FF]/,PERSIAN_REGEX:/^(?=.*[\u0600-\u06FF])[\u0600-\u06FF\u0660-\u0669\u06F0-\u06F9\u0041-\u005A\u0061-\u007A\u0030-\u0039\s.,:;ØŸ!()Â«Â»@#\n\t\u200C]+$/,PROMPT_BASE_FIELD:"You are a translation service. Your task is to translate text while strictly preserving its structure, formatting, and line breaks. Follow these rules:\n\n  - If the input is in $_{SOURCE}, translate it to $_{TARGET}.\n  - If the input is in $_{TARGET}, translate it to $_{SOURCE}.\n  - If the input is in any other language, translate it to $_{TARGET}.\n  - If the input has grammar mistakes but is in $_{TARGET}, translate it to $_{SOURCE} while preserving the intended meaning.\n\n  Return **only** the translated text without any extra words, explanations, markdown, or modifications.\n\n  ```text input\n  $_{TEXT}\n  ```\n  ",PROMPT_BASE_SELECT:'Act as an automated JSON translation service. The input is a JSON array where each object contains a "text" property.\n\n  1. Translate each "text" value according to the given rules: $_{USER_RULES}\n  2. Preserve all input elements. **Do not omit, modify, or skip any entry.**\n  3. If translation is not needed for a specific item (e.g., numbers, hashtags, URLs), **return the original value unchanged.**\n  4. Maintain the internal structure, formatting, and line breaks exactly.\n  5. Output **only** the translated JSON array, with no extra text, explanations, or markdown.\n\n  ```json input\n  $_{TEXT}\n  ```\n    ',PROMPT_BASE_DICTIONARY:'You are a $_{TARGET} dictionary service. Your task is to provide in detailed dictionary definitions while strictly preserving the input structure and formatting. Follow these rules:\n\n  - Provide the translation of the input word or phrase.\n  - Include synonyms, word type (noun, verb, adjective, etc.), and a brief definition.\n  - If applicable, provide example sentences using the word or phrase in context.\n  - If the input is ambiguous, return the most common meanings.\n  - If no definition is found, return "No definition available."\n\n  Return in $_{TARGET} language, and **ONLY** the dictionary entry without any extra words, explanations, markdown, or modifications.\n\n  ```text input\n  $_{TEXT}\n  ```\n  ',PROMPT_BASE_POPUP_TRANSLATE:"You are a translation service. Your task is to translate text while strictly preserving its structure, formatting, and line breaks. Follow these rules:\n\n  - If the input is in any language, translate it to $_{TARGET}.\n\n\n  Return **only** the translated text without any extra words, explanations, markdown, or modifications.\n\n  ```text input\n  $_{TEXT}\n  ```\n  ",PROMPT_TEMPLATE:"- If the input is in $_{SOURCE}, translate it to $_{TARGET}.\n- If the input is in $_{TARGET}, translate it to $_{SOURCE}.\n- If the input is in any other language, translate it to $_{TARGET}.\n- If the input has grammar mistakes but is in $_{TARGET}, translate it to $_{SOURCE} while preserving the intended meaning.",DEBUG_TRANSLATED_ENGLISH:"This is a mock translation to English.",DEBUG_TRANSLATED_PERSIAN:"Ø§ÛŒÙ† ÛŒÚ© ØªØ±Ø¬Ù…Ù‡ Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ Ø§Ø³Øª.",DEBUG_TRANSLATED_ENGLISH_With_NewLine:"This is a mock \ntranslation to English with \nnew lines.",DEBUG_TRANSLATED_PERSIAN_With_NewLine:"Ø§ÛŒÙ† ÛŒÚ© ØªØ±Ø¬Ù…Ù‡ Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ \nØ¨Ø±Ø§ÛŒ ØªØ±Ø¬Ù…Ù‡ Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ \nØ¨Ø§ Ø®Ø·ÙˆØ· Ø¬Ø¯ÛŒØ¯ Ø§Ø³Øª."},c={Field:"field",SelectElement:"select_element",Selection:"selection",Dictionary_Translation:"dictionary",Popup_Translate:"popup_translate"},u=(new Map,null),s=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(null===u){e.next=2;break}return e.abrupt("return",u);case 2:return e.abrupt("return",o().storage.local.get(null).then((function(e){return u=_objectSpread(_objectSpread({},i),e)}))["catch"]((function(e){return(0,a.tb)("Error fetching settings:",e),u=_objectSpread({},i)})));case 3:case"end":return e.stop()}}),_callee)})));return function(){return e.apply(this,arguments)}}();o()&&o().storage&&o().storage.onChanged?o().storage.onChanged.addListener((function(e,t){if("local"===t&&u){Object.keys(e).forEach((function(t){if(i.hasOwnProperty(t)||u&&u.hasOwnProperty(t)){var r=e[t].newValue;u[t]!==r&&(u[t]=r,!0)}}))}})):(0,a.tb)("Browser.storage.onChanged not available. Settings cache might become stale.");var l,f,h,p,y,d,v,g=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(e,t){var r,n;return _regeneratorRuntime().wrap((function(o){for(;1;)switch(o.prev=o.next){case 0:return o.next=2,s();case 2:return n=o.sent,o.abrupt("return",null!==(r=null==n?void 0:n[e])&&void 0!==r?r:t);case 4:case"end":return o.stop()}}),_callee2)})));return function(t,r){return e.apply(this,arguments)}}(),m=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("USE_MOCK",i.USE_MOCK));case 1:case"end":return e.stop()}}),_callee3)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("DEBUG_MODE",i.DEBUG_MODE));case 1:case"end":return e.stop()}}),_callee4)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(!u||void 0===u.DEBUG_MODE){e.next=2;break}return e.abrupt("return",u.DEBUG_MODE);case 2:return e.abrupt("return",_());case 3:case"end":return e.stop()}}),_callee5)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("API_KEY",i.API_KEY));case 1:case"end":return e.stop()}}),_callee6)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee7(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("API_URL",i.API_URL));case 1:case"end":return e.stop()}}),_callee7)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee8(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("APPLICATION_LOCALIZE",i.APPLICATION_LOCALIZE));case 1:case"end":return e.stop()}}),_callee8)})));return function(){return e.apply(this,arguments)}}(),A=(null&&(l=_asyncToGenerator(_regeneratorRuntime().mark((function _callee9(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("APP_NAME",i.APP_NAME));case 1:case"end":return e.stop()}}),_callee9)})))),null&&(f=_asyncToGenerator(_regeneratorRuntime().mark((function _callee10(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("EXTENSION_ENABLED",i.EXTENSION_ENABLED));case 1:case"end":return e.stop()}}),_callee10)})))),function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee11(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("SOURCE_LANGUAGE",i.SOURCE_LANGUAGE));case 1:case"end":return e.stop()}}),_callee11)})));return function(){return e.apply(this,arguments)}}()),T=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee12(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("TARGET_LANGUAGE",i.TARGET_LANGUAGE));case 1:case"end":return e.stop()}}),_callee12)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee13(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("ENABLE_DICTIONARY",i.ENABLE_DICTIONARY));case 1:case"end":return e.stop()}}),_callee13)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee14(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("PROMPT_TEMPLATE",i.PROMPT_TEMPLATE));case 1:case"end":return e.stop()}}),_callee14)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee15(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("PROMPT_BASE_DICTIONARY",i.PROMPT_BASE_DICTIONARY));case 1:case"end":return e.stop()}}),_callee15)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee16(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("PROMPT_BASE_POPUP_TRANSLATE",i.PROMPT_BASE_POPUP_TRANSLATE));case 1:case"end":return e.stop()}}),_callee16)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee17(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("PROMPT_BASE_SELECT",i.PROMPT_BASE_SELECT));case 1:case"end":return e.stop()}}),_callee17)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee18(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("PROMPT_BASE_FIELD",i.PROMPT_BASE_FIELD));case 1:case"end":return e.stop()}}),_callee18)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee19(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("TRANSLATION_API",i.TRANSLATION_API));case 1:case"end":return e.stop()}}),_callee19)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee20(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("WEBAI_API_URL",i.WEBAI_API_URL));case 1:case"end":return e.stop()}}),_callee20)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee21(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("WEBAI_API_MODEL",i.WEBAI_API_MODEL));case 1:case"end":return e.stop()}}),_callee21)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee22(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("OPENAI_API_KEY",i.OPENAI_API_KEY));case 1:case"end":return e.stop()}}),_callee22)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee23(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.OPENAI_API_URL);case 1:case"end":return e.stop()}}),_callee23)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee24(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("OPENAI_API_MODEL",i.OPENAI_API_MODEL));case 1:case"end":return e.stop()}}),_callee24)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee25(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("OPENROUTER_API_KEY",i.OPENROUTER_API_KEY));case 1:case"end":return e.stop()}}),_callee25)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee26(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("OPENROUTER_API_MODEL",i.OPENROUTER_API_MODEL));case 1:case"end":return e.stop()}}),_callee26)})));return function(){return e.apply(this,arguments)}}();null&&(h=_asyncToGenerator(_regeneratorRuntime().mark((function _callee27(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("TRANSLATE_ON_TEXT_FIELDS",i.TRANSLATE_ON_TEXT_FIELDS));case 1:case"end":return e.stop()}}),_callee27)})))),null&&(p=_asyncToGenerator(_regeneratorRuntime().mark((function _callee28(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("ENABLE_SHORTCUT_FOR_TEXT_FIELDS",i.ENABLE_SHORTCUT_FOR_TEXT_FIELDS));case 1:case"end":return e.stop()}}),_callee28)})))),null&&(y=_asyncToGenerator(_regeneratorRuntime().mark((function _callee29(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("TRANSLATE_WITH_SELECT_ELEMENT",i.TRANSLATE_WITH_SELECT_ELEMENT));case 1:case"end":return e.stop()}}),_callee29)})))),null&&(d=_asyncToGenerator(_regeneratorRuntime().mark((function _callee30(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("TRANSLATE_ON_TEXT_SELECTION",i.TRANSLATE_ON_TEXT_SELECTION));case 1:case"end":return e.stop()}}),_callee30)})))),null&&(v=_asyncToGenerator(_regeneratorRuntime().mark((function _callee31(){return _regeneratorRuntime().wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.abrupt("return",g("REQUIRE_CTRL_FOR_TEXT_SELECTION",i.REQUIRE_CTRL_FOR_TEXT_SELECTION));case 1:case"end":return e.stop()}}),_callee31)}))))},51318:(e,t,r)=>{"use strict";r.d(t,{z:()=>h});var n=r(50354),o=r(93061),a=r(4385),i=r(64019),c=r(48925),u=r(25980);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _toPropertyKey(e){var t=function(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_typeof(t)?t:t+""}var s=new Set([u.w.CONTEXT]),l=new Set([u.w.CONTEXT,u.w.API,u.w.API_KEY_INVALID,u.w.API_KEY_MISSING,u.w.API_URL_MISSING,u.w.MODEL_MISSING,u.w.MODEL_OVERLOADED,u.w.QUOTA_EXCEEDED,u.w.GEMINI_QUOTA_REGION,u.w.NETWORK_ERROR,u.w.HTTP_ERROR,u.w.INTEGRATION,u.w.SERVICE,u.w.VALIDATION,u.w.UI,u.w.PROMPT_INVALID,u.w.TEXT_EMPTY,u.w.TEXT_TOO_LONG,u.w.TRANSLATION_NOT_FOUND,u.w.TRANSLATION_FAILED,u.w.TAB_AVAILABILITY]),f=new Set([u.w.API_KEY_INVALID,u.w.API_KEY_MISSING,u.w.MODEL_OVERLOADED,u.w.MODEL_MISSING,u.w.API_URL_MISSING,u.w.QUOTA_EXCEEDED,u.w.HTTP_ERROR,u.w.GEMINI_QUOTA_REGION]),h=function(){return e=function ErrorHandler(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ErrorHandler),this.notifier=new o.A,this.displayedErrors=new Set,this.handling=!1},t=[{key:"handle",value:(p=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(e){var t,r,o,h,p,y=arguments;return _regeneratorRuntime().wrap((function(d){for(;1;)switch(d.prev=d.next){case 0:if(t=y.length>1&&void 0!==y[1]?y[1]:{},!this.handling){d.next=3;break}return d.abrupt("return",e);case 3:return this.handling=!0,d.prev=4,r=e instanceof Error?e.message:String(e),o=(0,i.H)(r),d.next=9,(0,c.u1)(o);case 9:return h=d.sent,d.next=12,(0,n.hL)()["catch"]((function(){return n.PI.DEBUG_MODE}));case 12:if(d.sent&&!l.has(o)&&console.error("[".concat(o,"] ").concat(r),e.stack),!s.has(o)){d.next=16;break}return d.abrupt("return",e);case 16:return p=f.has(o)?a.Ig:void 0,this._notifyUser(h,t.type||u.w.SERVICE,p),d.abrupt("return",e);case 19:return d.prev=19,this.handling=!1,d.finish(19);case 22:case"end":return d.stop()}}),_callee,this,[[4,,19,22]])}))),function(e){return p.apply(this,arguments)})},{key:"_logError",value:function(e,t){console.error("[ErrorService] ".concat(e.name,": ").concat(e.message,"\nContext: ").concat(t.context,"\nType: ").concat(t.type,"\nStack: ").concat(e.stack))}},{key:"_notifyUser",value:function(e,t,r){var n,o=this;if(!this.displayedErrors.has(e)){var a=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n={},u.w.API,"error"),u.w.UI,"error"),u.w.NETWORK_ERROR,"warning"),u.w.HTTP_ERROR,"warning"),u.w.SERVICE,"error"),u.w.CONTEXT,"warning"),u.w.VALIDATION,"warning"),u.w.INTEGRATION,"warning"),u.w.API_KEY_INVALID,"error"),u.w.API_KEY_MISSING,"error"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,u.w.API_URL_MISSING,"error"),u.w.MODEL_MISSING,"error"),u.w.MODEL_OVERLOADED,"warning"),u.w.QUOTA_EXCEEDED,"warning"),u.w.GEMINI_QUOTA_REGION,"warning"))[t]||"error";this.notifier.show(e,a,!0,4e3,r),this.displayedErrors.add(e),setTimeout((function(){return o.displayedErrors["delete"](e)}),4500)}}}],r=[{key:"processError",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(e){return _regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:if(null==e||!e.then){t.next=6;break}return t.next=3,e;case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=e;case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}}),_callee2)}))),function(e){return h.apply(this,arguments)})}],t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,h,p}()},63675:function(e,t){var r,n,o;!function(){if(1)n=[e],r=function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{const t="The message port closed before a response was received.",wrapAPIs=e=>{const r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(r).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class DefaultWeakMap extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const isThenable=e=>e&&"object"==typeof e&&"function"==typeof e.then,makeCallback=(t,r)=>(...n)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||n.length<=1&&!1!==r.singleCallbackArg?t.resolve(n[0]):t.resolve(n)},pluralizeArguments=e=>1==e?"argument":"arguments",wrapAsyncFunction=(e,t)=>function(r,...n){if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${pluralizeArguments(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${pluralizeArguments(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((o,a)=>{if(t.fallbackToNoCallback)try{r[e](...n,makeCallback({resolve:o,reject:a},t))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, `+"falling back to call it without a callback: ",a),r[e](...n),t.fallbackToNoCallback=!1,t.noCallback=!0,o()}else t.noCallback?(r[e](...n),o()):r[e](...n,makeCallback({resolve:o,reject:a},t))}))},wrapMethod=(e,t,r)=>new Proxy(t,{apply:(t,n,o)=>r.call(n,e,...o)});let n=Function.call.bind(Object.prototype.hasOwnProperty);const wrapObject=(e,t={},r={})=>{let o=Object.create(null),a={has:(t,r)=>r in e||r in o,get(a,i,c){if(i in o)return o[i];if(!(i in e))return;let u=e[i];if("function"==typeof u)if("function"==typeof t[i])u=wrapMethod(e,e[i],t[i]);else if(n(r,i)){let t=wrapAsyncFunction(i,r[i]);u=wrapMethod(e,e[i],t)}else u=u.bind(e);else if("object"==typeof u&&null!==u&&(n(t,i)||n(r,i)))u=wrapObject(u,t[i],r[i]);else{if(!n(r,"*"))return Object.defineProperty(o,i,{configurable:!0,enumerable:!0,get:()=>e[i],set(t){e[i]=t}}),u;u=wrapObject(u,t[i],r["*"])}return o[i]=u,u},set:(t,r,n,a)=>(r in o?o[r]=n:e[r]=n,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(o,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(o,t)},i=Object.create(e);return new Proxy(i,a)},wrapEvent=e=>({addListener(t,r,...n){t.addListener(e.get(r),...n)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),o=new DefaultWeakMap((e=>"function"!=typeof e?e:function(t){const r=wrapObject(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)})),a=new DefaultWeakMap((e=>"function"!=typeof e?e:function(t,r,n){let o,a,i=!1,c=new Promise((e=>{o=function(t){i=!0,e(t)}}));try{a=e(t,r,o)}catch(e){a=Promise.reject(e)}const u=!0!==a&&isThenable(a);if(!0!==a&&!u&&!i)return!1;const sendPromisedResult=e=>{e.then((e=>{n(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",n({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return sendPromisedResult(u?a:c),!0})),wrappedSendMessageCallback=({reject:r,resolve:n},o)=>{e.runtime.lastError?e.runtime.lastError.message===t?n():r(new Error(e.runtime.lastError.message)):o&&o.__mozWebExtensionPolyfillReject__?r(new Error(o.message)):n(o)},wrappedSendMessage=(e,t,r,...n)=>{if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${pluralizeArguments(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${pluralizeArguments(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,t)=>{const o=wrappedSendMessageCallback.bind(null,{resolve:e,reject:t});n.push(o),r.sendMessage(...n)}))},i={devtools:{network:{onRequestFinished:wrapEvent(o)}},runtime:{onMessage:wrapEvent(a),onMessageExternal:wrapEvent(a),sendMessage:wrappedSendMessage.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:wrappedSendMessage.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},c={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":c},services:{"*":c},websites:{"*":c}},wrapObject(e,i,r)};e.exports=wrapAPIs(chrome)}},void 0===(o="function"==typeof r?r.apply(t,n):r)||(e.exports=o);else;}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self)},64019:(e,t,r)=>{"use strict";r.d(t,{H:()=>matchErrorToType});var n=r(4385),o=r(25980);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function matchErrorToType(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("string"==typeof e){var t=e.trim();if(Object.values(o.w).includes(t))return t}if(e&&"object"===_typeof(e)){if(e.type)return e.type;var r=e.statusCode;if("number"==typeof r&&r>=400&&r<600)return o.w.HTTP_ERROR}var a=String(e).toLowerCase().trim();return/\b(403|404|500|502|503|504)\b/.test(a)?o.w.HTTP_ERROR:a.includes("text is empty")?o.w.TEXT_EMPTY:a.includes("prompt is invalid")?o.w.PROMPT_INVALID:a.includes("text is too long")||a.includes("too long")?o.w.TEXT_TOO_LONG:a.includes("translation not found")?o.w.TRANSLATION_NOT_FOUND:a.includes("translation failed")?o.w.TRANSLATION_FAILED:a.includes("wrong api key")||a.includes("api key not valid")||a.includes("no auth credentials")||a.includes("incorrect api key provided")||a.includes("api key expired")||a.includes("renew the api key")||a.includes("API key expired")||a.includes("renew the api key")?o.w.API_KEY_INVALID:a.includes("api key is missing")||a.includes("key missing")?o.w.API_KEY_MISSING:a.includes("api url")&&a.includes("missing")?o.w.API_URL_MISSING:a.includes("not a valid model id")||a.includes("invalid model")||a.includes("model not found")||a.includes("model is missing")||a.includes("model not available")||a.includes("the model `")&&a.includes("does not exist or you do not have access to it")?o.w.MODEL_MISSING:a.includes("the model is overloaded")||a.includes("overloaded")?o.w.MODEL_OVERLOADED:a.includes("quota exceeded")&&a.includes("region")?((0,n.tb)("[ErrorMatcher] Quota exceeded with region, indicating Gemini-specific quota."),o.w.GEMINI_QUOTA_REGION):a.includes("quota exceeded")||a.includes("gemini quota")?o.w.QUOTA_EXCEEDED:a.includes("failed to fetch")||a.includes("network failure")||a.includes("connection failed")||a.includes("networkerror")||a.includes("networkerror when attempting to fetch resource")?o.w.NETWORK_ERROR:a.includes("http error")||a.includes("http status")||a.includes("http response")||a.includes("operation was aborted")||a.includes("the operation was aborted.")?o.w.HTTP_ERROR:a.includes("context")||a.includes("context invalid")||a.includes("extension context")||a.includes("context invalidated")||a.includes("extension context invalidated")?o.w.CONTEXT:o.w.UNKNOWN}},85435:()=>{var e=null;chrome.runtime.onMessage.addListener((function(t,r,n){return"playOffscreenAudio"===t.action&&t.url?(e&&(e.pause(),e.src=""),(e=new Audio(t.url)).crossOrigin="anonymous",e.addEventListener("ended",(function(){n({success:!0}),e=null})),e.addEventListener("error",(function(t){n({success:!1,error:t.message||"Audio playback error"}),e=null})),e.play()["catch"]((function(t){n({success:!1,error:t.message}),e=null})),!0):"stopOffscreenAudio"===t.action?(e?(e.pause(),e.src="",e=null,n({success:!0})):n({success:!1,error:"No offscreen audio playing"}),!0):void 0}))},93061:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var n,o,a,i,c,u,s,l=r(63675),f=r.n(l),h=r(50354),p=r(4385),y=r(25980);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _toPropertyKey(e){var t=function(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_typeof(t)?t:t+""}var d={ICON_TRANSLATION:null!==(n=null===h.PI||void 0===h.PI?void 0:h.PI.ICON_TRANSLATION)&&void 0!==n?n:"ðŸŒ",ICON_SUCCESS:null!==(o=null===h.PI||void 0===h.PI?void 0:h.PI.ICON_SUCCESS)&&void 0!==o?o:"âœ…",ICON_WARNING:null!==(a=null===h.PI||void 0===h.PI?void 0:h.PI.ICON_WARNING)&&void 0!==a?a:"âš ï¸",ICON_STATUS:null!==(i=null===h.PI||void 0===h.PI?void 0:h.PI.ICON_STATUS)&&void 0!==i?i:"â³",ICON_ERROR:null!==(c=null===h.PI||void 0===h.PI?void 0:h.PI.ICON_ERROR)&&void 0!==c?c:"âŒ",ICON_INFO:null!==(u=null===h.PI||void 0===h.PI?void 0:h.PI.ICON_INFO)&&void 0!==u?u:"ðŸ”µ",ICON_REVERT:null!==(s=null===h.PI||void 0===h.PI?void 0:h.PI.ICON_REVERT)&&void 0!==s?s:"â†©ï¸"},v=function(){return e=function NotificationManager(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,NotificationManager),this.errorHandler=e||{handle:function(){}},this.map={error:{title:"AI Writing Companion - Error",icon:d.ICON_ERROR,cls:"AIWC-error",dur:5e3},warning:{title:"AI Writing Companion - Warning",icon:d.ICON_WARNING,cls:"AIWC-warning",dur:4e3},success:{title:"AI Writing Companion - Success",icon:d.ICON_SUCCESS,cls:"AIWC-success",dur:3e3},info:{title:"AI Writing Companion - Info",icon:d.ICON_INFO,cls:"AIWC-info",dur:3e3},status:{title:"AI Writing Companion - Status",icon:d.ICON_STATUS,cls:"AIWC-status",dur:2e3},revert:{title:"AI Writing Companion - Revert",icon:d.ICON_REVERT,cls:"AIWC-revert",dur:800}},this.container=null,"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){return t._makeContainer()}),{once:!0}):this._makeContainer()),f().storage&&f().storage.onChanged&&f().storage.onChanged.addListener((function(e,r){"local"===r&&e.APPLICATION_LOCALIZE&&t._applyAlignment()}))},t=[{key:"_applyAlignment",value:(n=_regeneratorRuntime().mark((function _callee(){var e;return _regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:if(this.container){t.next=2;break}return t.abrupt("return");case 2:try{(e=!0)?(this.container.style.right="20px",this.container.style.left=""):(this.container.style.left="20px",this.container.style.right=""),this.container.style.direction=e?"rtl":"ltr",this.container.style.textAlign=e?"right":"left"}catch(e){(0,p.tb)("[NotificationManager] _applyAlignment failed:",e)}case 3:case"end":return t.stop()}}),_callee,this)})),o=function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function _next(e){asyncGeneratorStep(a,r,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,r,o,_next,_throw,"throw",e)}_next(void 0)}))},function(){return o.apply(this,arguments)})},{key:"_makeContainer",value:function(){var e=null;try{var t="AIWritingCompanion-notifications";return(e=document.getElementById(t))?(this.container=e,this._applyAlignment(),e):document.body?(e=document.createElement("div"))?(e.id=t,Object.assign(e.style,{position:"fixed",top:"20px",zIndex:"2147483646",display:"flex",flexDirection:"column",gap:"10px"}),document.body.appendChild(e),this.container=e,this._applyAlignment(),e):((0,p.tb)("[NotificationManager] createElement failed."),null):((0,p.tb)("[NotificationManager] document.body not available."),null)}catch(t){return(0,p.tb)("[NotificationManager] _makeContainer error:",t),e&&e.remove&&e.remove(),null}}},{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4?arguments[4]:void 0,a=this.map[t]||this.map.info,i=null!=n?n:a.dur;if(this.container&&document.body.contains(this.container))try{return this._toastInPage(e,a,r,i,o)}catch(e){var c,u;return null===(c=(u=this.errorHandler).handle)||void 0===c||c.call(u,e,{type:y.w.UI,context:"NotificationManager-show"}),null}return this._sendToActiveTab(e,t,r,i,o),null}},{key:"dismiss",value:function(e){e&&"function"==typeof e.remove&&(e.style.opacity="0",setTimeout((function(){return e.remove()}),500))}},{key:"_toastInPage",value:function(e,t,r,n,o){var a=this,i=document.createElement("div");i.className="AIWC-notification ".concat(t.cls),i.style.cssText="\n      background:#fff;color:#333;padding:10px 15px;\n      border-radius:6px;font-size:14px;border:1px solid #ddd;\n      box-shadow:0 2px 8px rgba(0,0,0,0.1);display:flex;\n      align-items:center;cursor:pointer;opacity:1;\n      transition:opacity .5s";var c=document.createElement("span");c.textContent=t.icon;var u=document.createElement("span");return u.textContent=e,i.appendChild(c),i.appendChild(u),i.addEventListener("click",(function(){try{null==o||o()}catch(e){(0,p.tb)(e)}a.dismiss(i)})),this.container.appendChild(i),r&&"AIWC-status"!==t.cls&&setTimeout((function(){return a.dismiss(i)}),n),i}},{key:"_sendToActiveTab",value:function(e,t,r,n,o){var a=this;return f().tabs.query({active:!0,currentWindow:!0}).then((function(o){var a;return null!=o&&null!==(a=o[0])&&void 0!==a&&a.id&&(0,p.hA)()?f().tabs.sendMessage(o[0].id,{action:"show_notification",payload:{message:e,type:t,autoDismiss:r,duration:n}}):null})).then((function(e){if(o&&void 0!==e){var _listener=function(e){"notification_clicked"===(null==e?void 0:e.action)&&(o(),f().runtime.onMessage.removeListener(_listener))};f().runtime.onMessage.addListener(_listener)}}))["catch"]((function(){return a._osNotification(e,t,o)}))}},{key:"_osNotification",value:function(e,t,r){var n=this.map[t]||this.map.info;f().notifications.create({type:"basic",iconUrl:f().runtime.getURL("icons/extension_icon.png"),title:n.title,message:e}).then((function(e){if(r){var _click=function(t){t===e&&(r(),f().notifications.clear(e),f().notifications.onClicked.removeListener(_click))};f().notifications.onClicked.addListener(_click)}}))["catch"]((function(){}))}}],t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,o}()}},t={};function __webpack_require__(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=__webpack_require__(4385),t=__webpack_require__(63675),r=__webpack_require__.n(t);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,F=function(){};return{s:F,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(i)throw o}}}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function injectContentScript(e,t){return _injectContentScript.apply(this,arguments)}function _injectContentScript(){return(_injectContentScript=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(t,n){var o;return _regeneratorRuntime().wrap((function(a){for(;1;)switch(a.prev=a.next){case 0:if(a.prev=0,o=new URL(n),["http:","https:"].includes(o.protocol)){a.next=4;break}return a.abrupt("return");case 4:a.next=9;break;case 6:return a.prev=6,a.t0=a["catch"](0),a.abrupt("return");case 9:return a.prev=9,a.next=12,r().scripting.executeScript({target:{tabId:t,allFrames:!0},files:["browser-polyfill.js","content.bundle.js"]});case 12:a.next=17;break;case 14:a.prev=14,a.t1=a["catch"](9),(0,e.tb)("[Background-Injection] Failed to inject content script:",a.t1);case 17:case"end":return a.stop()}}),_callee3,null,[[0,6],[9,14]])})))).apply(this,arguments)}r().tabs.onUpdated.addListener(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(t,n,o){var a,i,c,u;return _regeneratorRuntime().wrap((function(s){for(;1;)switch(s.prev=s.next){case 0:if("complete"===n.status){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,r().storage.local.get(["EXTENSION_ENABLED","EXCLUDED_SITES"]);case 4:if(a=s.sent,i=a.EXTENSION_ENABLED,c=a.EXCLUDED_SITES,u=void 0===c?[]:c,i){s.next=10;break}return s.abrupt("return");case 10:if(!u.some((function(e){return o.url.includes(e)}))){s.next=14;break}return(0,e.tb)("[Injection] Skipped due to excluded site:",o.url),s.abrupt("return");case 14:injectContentScript(t,o.url);case 15:case"end":return s.stop()}}),_callee)})));return function(e,r,n){return t.apply(this,arguments)}}()),r().runtime.onInstalled.addListener(_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(){var e,t,n,o;return _regeneratorRuntime().wrap((function(a){for(;1;)switch(a.prev=a.next){case 0:return a.next=2,r().tabs.query({url:["http://*/*","https://*/*"]});case 2:e=a.sent,t=_createForOfIteratorHelper(e);try{for(t.s();!(n=t.n()).done;)injectContentScript((o=n.value).id,o.url)}catch(e){t.e(e)}finally{t.f()}case 5:case"end":return a.stop()}}),_callee2)}))));var n=__webpack_require__(51318),o=__webpack_require__(25980),a=__webpack_require__(50354);function promptBuilder_regeneratorRuntime(){promptBuilder_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==promptBuilder_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(promptBuilder_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function promptBuilder_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function promptBuilder_typeof(e){return promptBuilder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},promptBuilder_typeof(e)}function buildPrompt(e,t,r){return _buildPrompt.apply(this,arguments)}function _buildPrompt(){var t;return t=promptBuilder_regeneratorRuntime().mark((function _callee(t,r,n){var o,i,c,u,s,l,f,h,p,y,d=arguments;return promptBuilder_regeneratorRuntime().wrap((function(v){for(;1;)switch(v.prev=v.next){case 0:return o=d.length>3&&void 0!==d[3]?d[3]:a.t3.Field,v.next=3,(0,a.g6)();case 3:i=v.sent,c=t,u=!1;try{s=JSON.parse(t),g=s,Array.isArray(g)&&g.length>0&&g.every((function(e){return"object"===promptBuilder_typeof(e)&&null!==e&&"string"==typeof e.text}))&&(u=!0,c=t)}catch(e){c=t}if(!u){v.next=13;break}return v.next=10,(0,a.w1)();case 10:l=v.sent,v.next=37;break;case 13:if(o!==a.t3.Popup_Translate){v.next=19;break}return v.next=16,(0,a.lB)();case 16:l=v.sent,v.next=37;break;case 19:return v.next=21,(0,a._2)();case 21:if(v.t0=v.sent,!0!==v.t0){v.next=34;break}if(o!==a.t3.Dictionary_Translation){v.next=29;break}return v.next=26,(0,a.nC)();case 26:l=v.sent,v.next=32;break;case 29:return v.next=31,(0,a.ie)();case 31:l=v.sent;case 32:v.next=37;break;case 34:return v.next=36,(0,a.ie)();case 36:l=v.sent;case 37:return f=i.replace(/\$_{SOURCE}/g,r).replace(/\$_{TARGET}/g,n),h=l.replace(/\$_{SOURCE}/g,r).replace(/\$_{TARGET}/g,n),p=h.replace(/\$_{USER_RULES}/g,f),(0,e.tb)("Prompt : ",p),y=p.includes("$_{TEXT}")?p.replace(/\$_{TEXT}/g,c):"".concat(p,"\n\n ``` ").concat(c,"  ``` \n\n"),v.abrupt("return",y);case 43:case"end":return v.stop()}var g}),_callee)})),_buildPrompt=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function _next(e){promptBuilder_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){promptBuilder_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))},_buildPrompt.apply(this,arguments)}var i=__webpack_require__(10870);__webpack_require__(1771);function tts_typeof(e){return tts_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tts_typeof(e)}function tts_regeneratorRuntime(){tts_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==tts_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(tts_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function tts_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}var c="Auto Detect";function playAudioGoogleTTS(e,t){var r="https://translate.google.com/translate_tts?client=tw-ob&q=".concat(encodeURIComponent(e),"&tl=").concat(t),n=new Audio(r);n.crossOrigin="anonymous";var o=new Promise((function(e,t){n.addEventListener("ended",(function(){e({success:!0})})),n.addEventListener("error",(function(e){t(e)}))}));return n.play()["catch"]((function(e){return Promise.reject(e)})),{audio:n,playbackPromise:o}}function playAudioWebSpeech(t,r){return new Promise((function(n,o){if(!t||!t.trim())return o("No text to speak");var a=new SpeechSynthesisUtterance(t);a.lang=r,a.onend=function(){return n("Speech ended")},a.onerror=function(e){return o(e)};var setVoiceAndSpeak=function(){var t=speechSynthesis.getVoices();if(t&&0!==t.length){var n=t.find((function(e){return e.lang.toLowerCase().startsWith(r.toLowerCase())}));a.voice=n||t[0]}else(0,e.tb)("No voices available");speechSynthesis.cancel(),speechSynthesis.speak(a)};speechSynthesis.getVoices().length>0?setVoiceAndSpeak():speechSynthesis.onvoiceschanged=function(){setVoiceAndSpeak()}}))}function playAudioChromeTTS(e,t){return new Promise((function(r,n){var o;if(null===(o=chrome)||void 0===o||!o.tts)return n(new Error("chrome.tts not available"));chrome.tts.speak(e,{lang:t,onEvent:function(e){"end"===e.type?r({success:!0}):"error"===e.type&&n(new Error("Chrome TTS error: ".concat(e.errorMessage||"")))}})}))}function playAudioViaOffscreen(e){return _playAudioViaOffscreen.apply(this,arguments)}function _playAudioViaOffscreen(){var t;return t=tts_regeneratorRuntime().mark((function _callee(t){var n,o,a,i;return tts_regeneratorRuntime().wrap((function(u){for(;1;)switch(u.prev=u.next){case 0:if((0,e.tb)("[TTS:Offscreen] Attempting to play audio via offscreen."),(0,e.tb)("[TTS:Offscreen] Checking chrome.offscreen support..."),o=!(null===(n=chrome)||void 0===n||null===(n=n.offscreen)||void 0===n||!n.createDocument),(0,e.tb)("[TTS:Offscreen] chrome.offscreen supported: ".concat(o)),o){u.next=8;break}return(0,e.tb)("[TTS:Offscreen] Offscreen API not available. Falling back to Web Speech API."),playAudioWebSpeech(t,c),u.abrupt("return",{success:!0});case 8:return a=!1,u.prev=9,u.next=12,chrome.offscreen.hasDocument();case 12:a=u.sent,(0,e.tb)("[TTS:Offscreen] Offscreen document exists: ".concat(a)),u.next=20;break;case 16:return u.prev=16,u.t0=u["catch"](9),(0,e.tb)("[TTS:Offscreen] Error checking offscreen document existence:",u.t0),u.abrupt("return",{error:"Failed to check offscreen document existence."});case 20:if(a){u.next=36;break}return u.prev=21,(0,e.tb)("[TTS:Offscreen] Creating offscreen document..."),u.next=25,chrome.offscreen.createDocument({url:"html/offscreen.html",reasons:["AUDIO_PLAYBACK"],justification:"Play TTS audio from background script"});case 25:(0,e.tb)("[TTS:Offscreen] Offscreen document created."),u.next=36;break;case 28:if(u.prev=28,u.t1=u["catch"](21),!u.t1.message.includes("Only a single offscreen document")){u.next=34;break}(0,e.tb)("[TTS:Offscreen] Offscreen document already exists (caught duplication)."),u.next=36;break;case 34:return(0,e.tb)("[TTS:Offscreen] Failed to create offscreen document:",u.t1),u.abrupt("return",{error:"Failed to create offscreen document."});case 36:return u.prev=36,(0,e.tb)("[TTS:Offscreen] Sending message to offscreen player with URL:",t),u.next=40,r().runtime.sendMessage({action:"playOffscreenAudio",url:t});case 40:return i=u.sent,(0,e.tb)("[TTS:Offscreen] Response from offscreen:",i),u.next=44,r().offscreen.closeDocument();case 44:if((0,e.tb)("[TTS:Offscreen] Offscreen document closed."),i&&i.success){u.next=48;break}return(0,e.tb)("[TTS:Offscreen] Playback failed or response missing."),u.abrupt("return",{error:(null==i?void 0:i.error)||"Playback failed via offscreen."});case 48:return(0,e.tb)("[TTS:Offscreen] Audio playback successful via offscreen."),u.abrupt("return",{success:!0});case 52:return u.prev=52,u.t2=u["catch"](36),(0,e.tb)("[TTS:Offscreen] Error sending message or during playback:",u.t2),u.prev=55,u.next=58,r().offscreen.closeDocument();case 58:(0,e.tb)("[TTS:Offscreen] Offscreen document closed after error."),u.next=64;break;case 61:u.prev=61,u.t3=u["catch"](55),(0,e.tb)("[TTS:Offscreen] Error closing offscreen document:",u.t3);case 64:return u.abrupt("return",{error:u.t2.message||"Unknown offscreen playback error."});case 65:case"end":return u.stop()}}),_callee,null,[[9,16],[21,28],[36,52],[55,61]])})),_playAudioViaOffscreen=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function _next(e){tts_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){tts_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))},_playAudioViaOffscreen.apply(this,arguments)}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=r["return"]&&(i=r["return"](),Object(i)!==i))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return api_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?api_arrayLikeToArray(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function api_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function api_regeneratorRuntime(){api_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==api_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(api_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function api_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function api_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){api_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){api_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function api_typeof(e){return api_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},api_typeof(e)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _toPropertyKey(e){var t=function(e,t){if("object"!=api_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=api_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==api_typeof(t)?t:t+""}var u=500,s=function(){return t=function ApiService(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ApiService),this.sessionContext=null},n=[{key:"_isSpecificTextJsonFormat",value:function(e){return Array.isArray(e)&&e.length>0&&e.every((function(e){return"object"===api_typeof(e)&&null!==e&&"string"==typeof e.text}))}},{key:"_buildMessagePayload",value:function(e){var t="";try{var r=JSON.parse(e.fetchOptions.body);r.contents&&Array.isArray(r.contents)&&r.contents[0].parts?t=r.contents[0].parts[0].text:r.message?t=r.message:r.messages&&Array.isArray(r.messages)&&r.messages[0].content&&(t=r.messages[0].content)}catch(e){}return{promptText:t,sourceLanguage:e.sourceLanguage||c,targetLanguage:e.targetLanguage||c,translationMode:e.translationMode||""}}},{key:"_executeApiCall",value:(d=api_asyncToGenerator(api_regeneratorRuntime().mark((function _callee(e){var t,r,n,a,i,c,u,s,l,f,h,p,y;return api_regeneratorRuntime().wrap((function(d){for(;1;)switch(d.prev=d.next){case 0:return t=e.url,r=e.fetchOptions,n=e.extractResponse,a=e.context,d.prev=1,d.next=4,fetch(t,r);case 4:if((i=d.sent).ok){d.next=21;break}return u={},d.prev=7,d.next=10,i.json();case 10:u=d.sent,d.next=15;break;case 13:d.prev=13,d.t0=d["catch"](7);case 15:throw s=u.detail||(null===(c=u.error)||void 0===c?void 0:c.message)||i.statusText||"HTTP ".concat(i.status),(l=new Error(s)).type=o.w.HTTP_ERROR,l.statusCode=i.status,l.context=a,l;case 21:return d.next=23,i.json();case 23:if(f=d.sent,void 0!==(h=n(f,i.status))){d.next=31;break}throw(p=new Error(o.w.API_RESPONSE_INVALID)).type=o.w.API,p.statusCode=i.status,p.context=a,p;case 31:return d.abrupt("return",h);case 34:if(d.prev=34,d.t1=d["catch"](1),!(d.t1 instanceof TypeError&&/NetworkError/.test(d.t1.message))){d.next=41;break}throw(y=new Error(d.t1.message)).type=o.w.NETWORK_ERROR,y.context=a,y;case 41:throw d.t1;case 42:case"end":return d.stop()}}),_callee,null,[[1,34],[7,13]])}))),function(e){return d.apply(this,arguments)})},{key:"handleGeminiTranslation",value:(y=api_asyncToGenerator(api_regeneratorRuntime().mark((function _callee2(e,t,r,n){var i,c,u,s,l,f,h,p,y;return api_regeneratorRuntime().wrap((function(d){for(;1;)switch(d.prev=d.next){case 0:if(t!==r){d.next=2;break}return d.abrupt("return",null);case 2:return d.next=4,Promise.all([(0,a.M7)(),(0,a.YY)()]);case 4:if(i=d.sent,c=_slicedToArray(i,2),u=c[0],s=c[1],u){d.next=13;break}throw(l=new Error(o.w.API_KEY_MISSING)).type=o.w.API_KEY_MISSING,l.context="api-gemini-translation-apikey",l;case 13:if(s){d.next=18;break}throw(f=new Error(o.w.API_URL_MISSING)).type=o.w.API_URL_MISSING,f.context="api-gemini-translation-url",f;case 18:return d.next=20,buildPrompt(e,t,r,n);case 20:return h=d.sent,p="".concat(s,"?key=").concat(u),y={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}]})},d.abrupt("return",this._executeApiCall({url:p,fetchOptions:y,extractResponse:function(e){var t;return null==e||null===(t=e.candidates)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.content)||void 0===t||null===(t=t.parts)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.text},context:"api-gemini-translation"}));case 24:case"end":return d.stop()}}),_callee2,this)}))),function(e,t,r,n){return y.apply(this,arguments)})},{key:"handleWebAITranslation",value:(p=api_asyncToGenerator(api_regeneratorRuntime().mark((function _callee3(e,t,r,n){var i,c,u,s,l,f,h,p,y;return api_regeneratorRuntime().wrap((function(d){for(;1;)switch(d.prev=d.next){case 0:return d.next=2,Promise.all([(0,a.o7)(),(0,a.Ce)()]);case 2:if(i=d.sent,c=_slicedToArray(i,2),u=c[0],s=c[1],u){d.next=11;break}throw(l=new Error(o.w.API_URL_MISSING)).type=o.w.API,l.context="api-webai-url",l;case 11:if(s){d.next=16;break}throw(f=new Error(o.w.AI_MODEL_MISSING)).type=o.w.API,f.context="api-webai-model",f;case 16:return d.next=18,buildPrompt(e,t,r,n);case 18:return h=d.sent,p={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:h,model:s,images:[],reset_session:this.shouldResetSession()})},d.next=22,this._executeApiCall({url:u,fetchOptions:p,extractResponse:function(e){return"string"==typeof e.response?e.response:void 0},context:"api-webai-translation"});case 22:return y=d.sent,this.storeSessionContext({model:s,lastUsed:Date.now()}),d.abrupt("return",y);case 25:case"end":return d.stop()}}),_callee3,this)}))),function(e,t,r,n){return p.apply(this,arguments)})},{key:"handleOpenAITranslation",value:(h=api_asyncToGenerator(api_regeneratorRuntime().mark((function _callee4(e,t,r,n){var i,c,u,s,l,f,h,p,y;return api_regeneratorRuntime().wrap((function(d){for(;1;)switch(d.prev=d.next){case 0:return d.next=2,Promise.all([(0,a.e7)(),(0,a.OE)(),(0,a.A4)()]);case 2:if(i=d.sent,c=_slicedToArray(i,3),u=c[0],s=c[1],l=c[2],u){d.next=12;break}throw(f=new Error(o.w.API_KEY_MISSING)).type=o.w.API,f.context="api-openai-apikey",f;case 12:if(s){d.next=17;break}throw(h=new Error(o.w.API_URL_MISSING)).type=o.w.API,h.context="api-openai-url",h;case 17:return d.next=19,buildPrompt(e,t,r,n);case 19:return p=d.sent,y={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u)},body:JSON.stringify({model:l||"gpt-3.5-turbo",messages:[{role:"user",content:p}]})},d.abrupt("return",this._executeApiCall({url:s,fetchOptions:y,extractResponse:function(e){var t;return null==e||null===(t=e.choices)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.message)||void 0===t?void 0:t.content},context:"api-openai-translation"}));case 22:case"end":return d.stop()}}),_callee4,this)}))),function(e,t,r,n){return h.apply(this,arguments)})},{key:"handleOpenRouterTranslation",value:(f=api_asyncToGenerator(api_regeneratorRuntime().mark((function _callee5(e,t,n,i){var c,u,s,l,f,h,p;return api_regeneratorRuntime().wrap((function(y){for(;1;)switch(y.prev=y.next){case 0:return y.next=2,Promise.all([(0,a.ZL)(),(0,a.fz)()]);case 2:if(c=y.sent,u=_slicedToArray(c,2),s=u[0],l=u[1],s){y.next=11;break}throw(f=new Error(o.w.API_KEY_MISSING)).type=o.w.API,f.context="api-openrouter-apikey",f;case 11:return y.next=13,buildPrompt(e,t,n,i);case 13:return h=y.sent,p={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s),"HTTP-Referer":r().runtime.getURL("/"),"X-Title":r().runtime.getManifest().name},body:JSON.stringify({model:l||"openai/gpt-3.5-turbo",messages:[{role:"user",content:h}]})},y.abrupt("return",this._executeApiCall({url:a.PI.OPENROUTER_API_URL,fetchOptions:p,extractResponse:function(e){var t;return null==e||null===(t=e.choices)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.message)||void 0===t?void 0:t.content},context:"api-openrouter-translation"}));case 16:case"end":return y.stop()}}),_callee5,this)}))),function(e,t,r,n){return f.apply(this,arguments)})},{key:"storeSessionContext",value:function(e){this.sessionContext=_objectSpread(_objectSpread({},e),{},{timestamp:Date.now()})}},{key:"resetSessionContext",value:function(){this.sessionContext=null}},{key:"shouldResetSession",value:function(){return this.sessionContext&&Date.now()-this.sessionContext.lastUsed>3e5}},{key:"translateText",value:(l=api_asyncToGenerator(api_regeneratorRuntime().mark((function _callee6(t,r,n,c){var s,l,f,h,p,y,d,v;return api_regeneratorRuntime().wrap((function(g){for(;1;)switch(g.prev=g.next){case 0:return g.next=2,(0,a.A3)();case 2:if(!g.sent){g.next=7;break}return g.next=5,(0,e.cb)(u);case 5:return s=t.substring(0,50),g.abrupt("return",(0,i.yM)(s)?a.PI.DEBUG_TRANSLATED_ENGLISH:a.PI.DEBUG_TRANSLATED_PERSIAN);case 7:if((0,e.hA)()){g.next=12;break}throw(l=new Error(o.w.CONTEXT)).type=o.w.CONTEXT,l.context="api-translateText-context",l;case 12:return g.next=14,Promise.all([n||(0,a._u)(),c||(0,a.sR)()]);case 14:if(f=g.sent,h=_slicedToArray(f,2),p=h[0],y=h[1],p!==y||r===a.t3.Popup_Translate){g.next=20;break}return g.abrupt("return",null);case 20:return g.next=22,(0,a._r)();case 22:d=g.sent,g.t0=d,g.next="gemini"===g.t0?26:"webai"===g.t0?27:"openai"===g.t0?28:"openrouter"===g.t0?29:30;break;case 26:return g.abrupt("return",this.handleGeminiTranslation(t,p,y,r));case 27:return g.abrupt("return",this.handleWebAITranslation(t,p,y,r));case 28:return g.abrupt("return",this.handleOpenAITranslation(t,p,y,r));case 29:return g.abrupt("return",this.handleOpenRouterTranslation(t,p,y,r));case 30:throw(v=new Error(o.w.AI_MODEL_MISSING)).type=o.w.API,v.context="api-translateText-model",v;case 34:case"end":return g.stop()}}),_callee6,this)}))),function(e,t,r,n){return l.apply(this,arguments)})}],n&&_defineProperties(t.prototype,n),s&&_defineProperties(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,s,l,f,h,p,y,d}(),l=new s,f=l.translateText.bind(l);function injector_typeof(e){return injector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},injector_typeof(e)}function injector_regeneratorRuntime(){injector_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==injector_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(injector_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function injector_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function injector_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){injector_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){injector_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function _tryInjectIfNeeded(){return(_tryInjectIfNeeded=injector_asyncToGenerator(injector_regeneratorRuntime().mark((function _callee(t){var n,o,a,i,c,u,s,l;return injector_regeneratorRuntime().wrap((function(f){for(;1;)switch(f.prev=f.next){case 0:if(n=t.tabId,o=t.url,f.prev=1,c=new URL(o),["http:","https:"].includes(c.protocol)){f.next=5;break}return f.abrupt("return",!1);case 5:return f.next=7,r().storage.local.get(["EXCLUDED_SITES"]);case 7:if(u=f.sent,s=null!==(a=u.EXCLUDED_SITES)&&void 0!==a?a:[],!s.some((function(e){return o.includes(e)}))){f.next=13;break}return(0,e.tb)("[Injector] Skipped injection for excluded site: ".concat(o)),f.abrupt("return",!1);case 13:return f.next=15,r().scripting.executeScript({target:{tabId:n},func:function(){return!!window.__AI_WRITING_EXTENSION_ACTIVE__}});case 15:if(l=f.sent,null==l||null===(i=l[0])||void 0===i?void 0:i.result){f.next=22;break}return f.next=20,r().scripting.executeScript({target:{tabId:n},files:["browser-polyfill.js","content.bundle.js"]});case 20:f.next=24;break;case 22:return(0,e.tb)("[Injector] Script already active in tab ".concat(n)),f.abrupt("return",!1);case 24:f.next=30;break;case 26:return f.prev=26,f.t0=f["catch"](1),(0,e.tb)("[Injector] Injection error for tab ".concat(n,": ").concat(f.t0.message)),f.abrupt("return",!1);case 30:case"end":return f.stop()}}),_callee,null,[[1,26]])})))).apply(this,arguments)}function getSelectedTextHandler_typeof(e){return getSelectedTextHandler_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},getSelectedTextHandler_typeof(e)}function getSelectedTextHandler_regeneratorRuntime(){getSelectedTextHandler_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==getSelectedTextHandler_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(getSelectedTextHandler_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function getSelectedTextHandler_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _handleGetSelectedText(){var t;return t=getSelectedTextHandler_regeneratorRuntime().mark((function _callee(t,n,a,i){var c,u,s,l;return getSelectedTextHandler_regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:return(0,e.tb)("[Handler:GetSelectedText] Handling request."),t.prev=1,t.next=4,r().tabs.query({active:!0,currentWindow:!0});case 4:if(c=t.sent,u=c[0],s=!n.tab,u){t.next=9;break}throw new Error(o.w.TAB_AVAILABILITY);case 9:if(!(s||n.tab&&n.tab.id===u.id)){t.next=17;break}return t.next=12,i(u.id,{action:"getSelectedText"});case 12:l=t.sent,(0,e.tb)("[Handler:GetSelectedText] Got:",l),a(l||{selectedText:""}),t.next=18;break;case 17:a({selectedText:""});case 18:t.next=24;break;case 20:t.prev=20,t.t0=t["catch"](1),(0,e.tb)("[Handler:GetSelectedText] Error:",t.t0),a({selectedText:"",error:String(t.t0)});case 24:return t.abrupt("return",!0);case 25:case"end":return t.stop()}}),_callee,null,[[1,20]])})),_handleGetSelectedText=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function _next(e){getSelectedTextHandler_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){getSelectedTextHandler_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))},_handleGetSelectedText.apply(this,arguments)}var h=__webpack_require__(4446);function backgroundHandlers_typeof(e){return backgroundHandlers_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},backgroundHandlers_typeof(e)}function backgroundHandlers_regeneratorRuntime(){backgroundHandlers_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==backgroundHandlers_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(backgroundHandlers_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function backgroundHandlers_slicedToArray(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=r["return"]&&(i=r["return"](),Object(i)!==i))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return backgroundHandlers_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?backgroundHandlers_arrayLikeToArray(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function backgroundHandlers_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function backgroundHandlers_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function backgroundHandlers_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){backgroundHandlers_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){backgroundHandlers_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function _handleRevertBackground(){return(_handleRevertBackground=backgroundHandlers_asyncToGenerator(backgroundHandlers_regeneratorRuntime().mark((function _callee(){var t,n,o,a;return backgroundHandlers_regeneratorRuntime().wrap((function(i){for(;1;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,r().tabs.query({active:!0,currentWindow:!0});case 3:if(t=i.sent,n=backgroundHandlers_slicedToArray(t,1),null!=(o=n[0])&&o.id){i.next=9;break}return(0,e.tb)("[Handler:Revert] No active tab or tab ID found"),i.abrupt("return");case 9:return i.prev=9,i.next=12,r().tabs.sendMessage(o.id,{action:"revertAllAndEscape",source:"background"});case 12:i.next=20;break;case 14:if(i.prev=14,i.t0=i["catch"](9),!(a=(null===i.t0||void 0===i.t0?void 0:i.t0.message)||"").includes("Could not establish connection")){i.next=19;break}return i.abrupt("return");case 19:(0,e.tb)("[Handler:Revert] Failed to send message to tab ".concat(o.id,": ").concat(a));case 20:i.next=25;break;case 22:i.prev=22,i.t1=i["catch"](0),(0,e.tb)("[Handler:Revert] Failed to query active tab: "+i.t1.message);case 25:case"end":return i.stop()}}),_callee,null,[[0,22],[9,14]])})))).apply(this,arguments)}function _handleFetchTranslation(){return _handleFetchTranslation=backgroundHandlers_asyncToGenerator(backgroundHandlers_regeneratorRuntime().mark((function _callee2(t,n,a,i,c){var u,s,l,f,p,y,d,v,g,m,_,w,b,x;return backgroundHandlers_regeneratorRuntime().wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:if((0,e.tb)("[Handler:Translation] Handling fetchTranslation request"),n.prev=1,u=t.payload,s=u.promptText,l=u.targetLanguage,f=u.sourceLanguage,p=u.translateMode,s){n.next=7;break}throw(y=new Error(o.w.TEXT_EMPTY)).type=o.w.TEXT_EMPTY,y;case 7:return n.next=9,i(s,p,f,l);case 9:if("string"==typeof(d=n.sent)&&d.trim()){n.next=14;break}throw(v=new Error(o.w.TRANSLATION_FAILED)).type=o.w.API,v;case 14:return n.next=16,r().storage.local.set({lastTranslation:{sourceText:s,translatedText:d,sourceLanguage:f,targetLanguage:l}});case 16:a({success:!0,data:{translatedText:d}}),n.next=34;break;case 19:return n.prev=19,n.t0=n["catch"](1),n.next=23,c.handle(n.t0,{type:n.t0.type||o.w.API,context:"handler-fetchTranslation",metadata:{targetLang:null===(g=t.payload)||void 0===g?void 0:g.targetLanguage,sourceLang:null===(m=t.payload)||void 0===m?void 0:m.sourceLanguage}});case 23:if(b=n.sent,n.t2=(null==b||null===(_=b.message)||void 0===_?void 0:_.trim())||(null===n.t0||void 0===n.t0||null===(w=n.t0.message)||void 0===w?void 0:w.trim()),n.t2){n.next=29;break}return n.next=28,(0,h.bQ)("ERRORS_DURING_TRANSLATE_Fetch");case 28:n.t2=n.sent;case 29:if(n.t1=n.t2,n.t1){n.next=32;break}n.t1="(âš ï¸ Ø®Ø·Ø§ÛŒÛŒ Ø¯Ø± ØªØ±Ø¬Ù…Ù‡ Ø±Ø® Ø¯Ø§Ø¯.)";case 32:x=n.t1,a({success:!1,error:x});case 34:case"end":return n.stop()}}),_callee2,null,[[1,19]])}))),_handleFetchTranslation.apply(this,arguments)}function _handleFetchTranslationBackground(){return _handleFetchTranslationBackground=backgroundHandlers_asyncToGenerator(backgroundHandlers_regeneratorRuntime().mark((function _callee3(t,n,i,c,u){var s,l,f,p,y,d,v,g,m,_,w,b,x;return backgroundHandlers_regeneratorRuntime().wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:if((0,e.tb)("[Background] fetchTranslationBackground"),n.prev=1,s=t.payload,l=s.promptText,f=s.targetLanguage,p=s.sourceLanguage,y=s.translationMode,l){n.next=7;break}throw(d=new Error(o.w.PROMPT_INVALID)).type=o.w.PROMPT_INVALID,d;case 7:return n.next=9,c(l,y,p,f);case 9:if("string"==typeof(v=n.sent)&&v.trim()){n.next=12;break}throw new Error(o.w.TRANSLATION_FAILED);case 12:if(y===a.t3.SelectElement){n.next=15;break}return n.next=15,r().storage.local.set({lastTranslation:{sourceText:l,translatedText:v,sourceLanguage:p,targetLanguage:f}});case 15:i({success:!0,data:{translatedText:v}}),n.next=33;break;case 18:return n.prev=18,n.t0=n["catch"](1),n.next=22,u.handle(n.t0,{type:n.t0.type||o.w.API,context:"handler-fetchTranslation-background",metadata:{targetLang:null===(g=t.payload)||void 0===g?void 0:g.targetLanguage,sourceLang:null===(m=t.payload)||void 0===m?void 0:m.sourceLanguage}});case 22:if(b=n.sent,n.t2=(null==b||null===(_=b.message)||void 0===_?void 0:_.trim())||(null===n.t0||void 0===n.t0||null===(w=n.t0.message)||void 0===w?void 0:w.trim()),n.t2){n.next=28;break}return n.next=27,(0,h.bQ)("ERRORS_DURING_TRANSLATE_Fetch_BACKGROUND_FAILED");case 27:n.t2=n.sent;case 28:if(n.t1=n.t2,n.t1){n.next=31;break}n.t1="(âš ï¸ Ø®Ø·Ø§ÛŒÛŒ Ø¯Ø± ØªØ±Ø¬Ù…Ù‡ Ø±Ø® Ø¯Ø§Ø¯.)";case 31:x=n.t1,i({success:!1,error:x});case 33:case"end":return n.stop()}}),_callee3,null,[[1,18]])}))),_handleFetchTranslationBackground.apply(this,arguments)}function elementModeHandler_typeof(e){return elementModeHandler_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},elementModeHandler_typeof(e)}function elementModeHandler_regeneratorRuntime(){elementModeHandler_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==elementModeHandler_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(elementModeHandler_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function elementModeHandler_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _handleActivateSelectElementMode(){var t;return t=elementModeHandler_regeneratorRuntime().mark((function _callee(t,n,a,i,c,u){var s,l,f,h,p,y,d,v,g,m,_,w;return elementModeHandler_regeneratorRuntime().wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:return(0,e.tb)("[Handler:ElementMode] Toggling select-element-modeâ€¦"),n.prev=1,n.next=4,r().tabs.query({active:!0,currentWindow:!0});case 4:if(h=n.sent,null!==(l=h[0])&&void 0!==l&&l.id){n.next=9;break}throw(p=new Error(o.w.TAB_AVAILABILITY)).type=o.w.TAB_AVAILABILITY,p;case 9:return s=h[0].id,n.next=12,r().storage.local.get("selectElementState");case 12:return y=n.sent,d=y.selectElementState,v=void 0!==d&&d,g="boolean"==typeof t.data?t.data:!v,(0,e.tb)("[Handler:ElementMode] Setting selectElementState â†’ ".concat(g)),n.next=19,r().storage.local.set({selectElementState:g});case 19:return n.next=21,i(s,{action:"TOGGLE_SELECT_ELEMENT_MODE",data:g});case 21:if(m=n.sent,null===(f=m)||void 0===f||!f.error||u.inProgress){n.next=45;break}return u.inProgress=!0,n.prev=24,n.next=27,r().scripting.executeScript({target:{tabId:s},files:["browser-polyfill.js","content.bundle.js"]});case 27:return n.next=29,i(s,{action:"TOGGLE_SELECT_ELEMENT_MODE",data:g});case 29:if(m=n.sent,null===(_=m)||void 0===_||!_.error){n.next=34;break}throw(w=new Error(m.error)).type=o.w.INTEGRATION,w;case 34:n.next=42;break;case 36:return n.prev=36,n.t0=n["catch"](24),n.next=40,c.handle(n.t0,{type:o.w.INTEGRATION,context:"handler-elementMode-injection"});case 40:return a({success:!1,error:"Could not inject content script."}),n.abrupt("return");case 42:return n.prev=42,u.inProgress=!1,n.finish(42);case 45:a({success:!0,newState:g}),n.next=54;break;case 48:return n.prev=48,n.t1=n["catch"](1),n.next=52,c.handle(n.t1,{type:n.t1.type||o.w.INTEGRATION,context:"handler-activateSelectElementMode"});case 52:a({success:!1,error:n.t1.message}),u.inProgress&&(u.inProgress=!1);case 54:case"end":return n.stop()}}),_callee,null,[[1,48],[24,36,42,45]])})),_handleActivateSelectElementMode=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function _next(e){elementModeHandler_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){elementModeHandler_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))},_handleActivateSelectElementMode.apply(this,arguments)}function resolveLangCode(e){if(!e||e.toLowerCase()===c)return"en";var t=e.trim().toLowerCase(),r=(0,i.UK)(t);return null!=r&&r.code?r.code:"en"}function tts_player_typeof(e){return tts_player_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tts_player_typeof(e)}function tts_player_regeneratorRuntime(){tts_player_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==tts_player_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(tts_player_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function tts_player_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function tts_player_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){tts_player_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){tts_player_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}var p=null;function _playTTS(){return(_playTTS=tts_player_asyncToGenerator(tts_player_regeneratorRuntime().mark((function _callee(t){var n,o,a,u,s,l,f,h,y,d,v,g,m,_;return tts_player_regeneratorRuntime().wrap((function(w){for(;1;)switch(w.prev=w.next){case 0:if(stopTTS(),o=null==t||null===(n=t.text)||void 0===n?void 0:n.trim()){w.next=4;break}throw new Error("No text provided for TTS.");case 4:if((a=(null==t?void 0:t.lang)||c)!==c){w.next=17;break}return w.prev=6,w.next=9,(0,i.FL)(o);case 9:u=w.sent,a=u||"en",w.next=17;break;case 13:w.prev=13,w.t0=w["catch"](6),(0,e.tb)("[TTS] Language detection failed. Fallback to 'en'.",w.t0),a="en";case 17:if(s=resolveLangCode(a),(0,e.tb)("[TTS] Final language to play:",s),l=!1,w.prev=20,"function"!=typeof r().runtime.getBrowserInfo){w.next=26;break}return w.next=24,r().runtime.getBrowserInfo();case 24:f=w.sent,l="firefox"===f.name.toLowerCase();case 26:w.next=31;break;case 28:w.prev=28,w.t1=w["catch"](20),(0,e.tb)("[TTS] Could not get browser info, assuming Chrome-like environment.");case 31:if(!l){w.next=40;break}return(0,e.tb)("[TTS] On Firefox, falling back to Google TTS method."),h=playAudioGoogleTTS(o,s),y=h.audio,d=h.playbackPromise,p={method:"google",audio:y},w.next=37,d["catch"]((function(t){throw(0,e.tb)("GoogleTTS error:",t),t}))["finally"]((function(){p=null}));case 37:return w.abrupt("return",{success:!0});case 40:if(w.prev=40,"undefined"==typeof chrome||!chrome.tts){w.next=48;break}return(0,e.tb)("[TTS] Attempting chrome.tts..."),v=playAudioChromeTTS(o,s),p={method:"chrome"},w.next=47,v["catch"]((function(t){throw(0,e.tb)("[TTS] chrome.tts error:",t),t}))["finally"]((function(){p=null}));case 47:return w.abrupt("return",{success:!0});case 48:w.next=53;break;case 50:w.prev=50,w.t2=w["catch"](40),(0,e.tb)("[TTS] chrome.tts failed, fallback offscreen...",w.t2);case 53:return g="https://translate.google.com/translate_tts?client=tw-ob&q=".concat(encodeURIComponent(o),"&tl=").concat(s),(0,e.tb)("[TTS] Fallback to offscreen TTS..."),m=playAudioViaOffscreen(g),p={method:"offscreen"},w.next=59,m["catch"]((function(e){throw p=null,e}))["finally"]((function(){p=null}));case 59:if(!(_=w.sent).success){w.next=62;break}return w.abrupt("return",{success:!0});case 62:throw new Error(_.error||"TTS playback failed via offscreen.");case 63:case"end":return w.stop()}}),_callee,null,[[6,13],[20,28],[40,50]])})))).apply(this,arguments)}function stopTTS(){if(p){(0,e.tb)("Stopping TTS method:",p.method);try{switch(p.method){case"google":p.audio&&(p.audio.pause(),p.audio.src="");break;case"chrome":"undefined"!=typeof chrome&&chrome.tts&&chrome.tts.stop();break;case"webspeech":speechSynthesis.cancel();break;case"offscreen":!function(){_stopAudioViaOffscreen.apply(this,arguments)}();break;default:(0,e.tb)("Unknown TTS method to stop:",p.method)}}catch(t){(0,e.tb)("Error stopping TTS:",t)}p=null}}function _stopAudioViaOffscreen(){return(_stopAudioViaOffscreen=tts_player_asyncToGenerator(tts_player_regeneratorRuntime().mark((function _callee2(){var t;return tts_player_regeneratorRuntime().wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:if(n.prev=0,null!==(t=chrome.offscreen)&&void 0!==t&&t.hasDocument){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,chrome.offscreen.hasDocument();case 5:if(n.sent){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,r().runtime.sendMessage({action:"stopOffscreenAudio"});case 10:return n.next=12,r().offscreen.closeDocument();case 12:(0,e.tb)("Offscreen stopped and closed."),n.next=18;break;case 15:n.prev=15,n.t0=n["catch"](0),(0,e.tb)("Error stopping offscreen audio:",n.t0);case 18:case"end":return n.stop()}}),_callee2,null,[[0,15]])})))).apply(this,arguments)}function onMessage_typeof(e){return onMessage_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},onMessage_typeof(e)}function onMessage_regeneratorRuntime(){onMessage_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==onMessage_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(onMessage_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function onMessage_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}var y={},d={inProgress:!1},v=new n.z;function safeSendMessage(e,t){return _safeSendMessage.apply(this,arguments)}function _safeSendMessage(){var t;return t=onMessage_regeneratorRuntime().mark((function _callee(t,n){var o;return onMessage_regeneratorRuntime().wrap((function(a){for(;1;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,r().tabs.sendMessage(t,n);case 3:return a.abrupt("return",a.sent);case 6:if(a.prev=6,a.t0=a["catch"](0),!(o=a.t0.message||"").includes("message port closed")&&!o.includes("Could not establish connection")){a.next=12;break}return(0,e.tb)("[onMessage] No receiver (ignored)."),a.abrupt("return",{});case 12:return(0,e.tb)("[onMessage] Error:",o),a.abrupt("return",{error:o});case 14:case"end":return a.stop()}}),_callee,null,[[0,6]])})),_safeSendMessage=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function _next(e){onMessage_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){onMessage_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))},_safeSendMessage.apply(this,arguments)}r().runtime.onConnect.addListener((function(t){"popup"===t.name&&((0,e.tb)("[onMessage] Popup connected"),t.onDisconnect.addListener((function(){(0,e.tb)("[onMessage] Popup closed. Sending stopTTS."),stopTTS()})))})),r().runtime.onMessage.addListener((function(t,n,a){var i,c,u=(null==t?void 0:t.action)||(null==t?void 0:t.type);if((0,e.tb)("[onMessage] Action: ".concat(u),{message:t,sender:{id:n.id,url:n.url,tab:null===(i=n.tab)||void 0===i?void 0:i.id}}),!u)return(0,e.tb)("[onMessage] No action/type provided. Messag: ",t),a({error:"Missing action/type."}),!1;try{switch(u){case"CONTEXT_INVALID":case"EXTENSION_RELOADED":case"restart_content_script":return function(t,n,a,i){var c=t.action||t.type;(0,e.tb)("[Handler:Lifecycle] Handling action: ".concat(c));try{(0,e.tb)("[Handler:Lifecycle] Reloading extension due to action: ".concat(c)),r().runtime.reload()}catch(t){var u;(0,e.tb)("[Handler:Lifecycle] Reload failed, attempting content script injection:",t),null!==(u=n.tab)&&void 0!==u&&u.id&&r().scripting.executeScript({target:{tabId:n.tab.id},files:["content.bundle.js"]})["catch"]((function(t){(0,e.tb)("[Handler:Lifecycle] Content script injection fallback failed:",t),i.handle(t,{type:o.w.INTEGRATION,context:"handler-lifecycle-injection-fallback"})}))}return!1}(t,n,0,v);case"BACKGROUND_RELOAD_EXTENSION":return setTimeout((function(){}),100),!1;case"getSelectedText":return function(e,t,r,n){_handleGetSelectedText.apply(this,arguments)}(t,n,a,safeSendMessage),!0;case"UPDATE_SELECT_ELEMENT_STATE":return function(t,r,n){var o;null!==(o=r.tab)&&void 0!==o&&o.id?(n[r.tab.id]=t.data,(0,e.tb)("[Handler:State] Updated selectElementState for tab ".concat(r.tab.id,":"),t.data)):(0,e.tb)("[Handler:State] Received UPDATE_SELECT_ELEMENT_STATE without tab ID.")}(t,n,y),a({}),!1;case"speak":return function(e){return _playTTS.apply(this,arguments)}(t).then((function(){return a({success:!0})}))["catch"]((function(e){return a({success:!1,error:e.message})})),!0;case"stopTTS":return stopTTS(),a({success:!0}),!0;case"CONTENT_SCRIPT_WILL_RELOAD":return(0,e.tb)("[onMessage] Content script will reload."),!1;case"fetchTranslation":return function(e,t,r,n,o){_handleFetchTranslation.apply(this,arguments)}(t,n,a,f,v),!0;case"fetchTranslationBackground":return function(e,t,r,n,o){_handleFetchTranslationBackground.apply(this,arguments)}(t,n,a,f,v),!0;case"revertTranslation":return function(){_handleRevertBackground.apply(this,arguments)}(),a({success:!0}),!1;case"activateSelectElementMode":return function(e,t,r,n,o,a){_handleActivateSelectElementMode.apply(this,arguments)}(t,n,a,safeSendMessage,v,d),!0;case"TRY_INJECT_IF_NEEDED":return new Promise((function(r){var n=!1;(function(e){return _tryInjectIfNeeded.apply(this,arguments)})({tabId:t.tabId,url:t.url}).then((function(e){a({success:e}),n=!0,r()}))["catch"]((function(t){(0,e.tb)("[onMessage] Injection check failed:",t),a({success:!1}),n=!0,r()})),setTimeout((function(){n||a({success:!1,timeout:!0}),r()}),100)}));case"applyTranslationToActiveElement":return null!==(c=n.tab)&&void 0!==c&&c.id?(safeSendMessage(n.tab.id,t).then((function(e){return a(e)}))["catch"]((function(t){(0,e.tb)("[onMessage] Forward error:",t),a({success:!1,error:t.message})})),!0):(a({success:!1,error:"No valid tab."}),!1);default:return(0,e.tb)("[onMessage]Unhandled action:",u),!1}}catch(e){return v.handle(e,{type:o.w.SERVICE,context:"background-onMessage"}),a({error:e.message}),!1}})),r().tabs.onRemoved.addListener((function(t){null!=y[t]&&(delete y[t],(0,e.tb)("[onMessage] Cleaned state for tab ".concat(t)))}));__webpack_require__(85435),__webpack_require__(5266);function cleanupSelectionWindows_typeof(e){return cleanupSelectionWindows_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cleanupSelectionWindows_typeof(e)}function cleanupSelectionWindows_createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return cleanupSelectionWindows_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cleanupSelectionWindows_arrayLikeToArray(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,F=function(){};return{s:F,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(i)throw o}}}}function cleanupSelectionWindows_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function cleanupSelectionWindows_regeneratorRuntime(){cleanupSelectionWindows_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==cleanupSelectionWindows_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(cleanupSelectionWindows_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function cleanupSelectionWindows_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function cleanupSelectionWindows_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){cleanupSelectionWindows_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){cleanupSelectionWindows_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function dismissAllSelectionWindowsInTab(e){return _dismissAllSelectionWindowsInTab.apply(this,arguments)}function _dismissAllSelectionWindowsInTab(){return(_dismissAllSelectionWindowsInTab=cleanupSelectionWindows_asyncToGenerator(cleanupSelectionWindows_regeneratorRuntime().mark((function _callee(t){var n;return cleanupSelectionWindows_regeneratorRuntime().wrap((function(o){for(;1;)switch(o.prev=o.next){case 0:if(o.prev=0,n=function(){document.querySelectorAll(".aiwc-selection-popup-host").forEach((function(t){try{t.remove()}catch(t){(0,e.tb)("[SelectionWindows] remove failed:",t)}}))},!r().scripting||!r().scripting.executeScript){o.next=7;break}return o.next=5,r().scripting.executeScript({target:{tabId:t},func:n});case 5:o.next=9;break;case 7:return o.next=9,r().tabs.executeScript(t,{func:n});case 9:o.next=13;break;case 11:o.prev=11,o.t0=o["catch"](0);case 13:case"end":return o.stop()}}),_callee,null,[[0,11]])})))).apply(this,arguments)}function _dismissAllSelectionWindows(){return(_dismissAllSelectionWindows=cleanupSelectionWindows_asyncToGenerator(cleanupSelectionWindows_regeneratorRuntime().mark((function _callee2(){var t,n,o,a;return cleanupSelectionWindows_regeneratorRuntime().wrap((function(i){for(;1;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,r().tabs.query({url:"<all_urls>"});case 3:t=i.sent,n=cleanupSelectionWindows_createForOfIteratorHelper(t),i.prev=5,n.s();case 7:if((o=n.n()).done){i.next=15;break}if((a=o.value).id){i.next=11;break}return i.abrupt("continue",13);case 11:return i.next=13,dismissAllSelectionWindowsInTab(a.id);case 13:i.next=7;break;case 15:i.next=20;break;case 17:i.prev=17,i.t0=i["catch"](5),n.e(i.t0);case 20:return i.prev=20,n.f(),i.finish(20);case 23:i.next=28;break;case 25:i.prev=25,i.t1=i["catch"](0),(0,e.tb)("[SelectionWindows] dismissAllSelectionWindows failed:",i.t1);case 28:case"end":return i.stop()}}),_callee2,null,[[0,25],[5,17,20,23]])})))).apply(this,arguments)}function EventRouter_typeof(e){return EventRouter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EventRouter_typeof(e)}function EventRouter_regeneratorRuntime(){EventRouter_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==EventRouter_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(EventRouter_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function EventRouter_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function EventRouter_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){EventRouter_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){EventRouter_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function EventRouter_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EventRouter_toPropertyKey(n.key),n)}}function EventRouter_toPropertyKey(e){var t=function(e,t){if("object"!=EventRouter_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=EventRouter_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==EventRouter_typeof(t)?t:t+""}r().alarms.create("wake",{delayInMinutes:.1}),r().alarms.onAlarm.addListener((function(e){"wake"===e.name&&(console.info("[AI Writing Companion] â° Wake alarm triggered!"),Promise.resolve().then(__webpack_require__.bind(__webpack_require__,5266)))}));var g,m,_,w,b,x,E,A,T,I;null&&(g=function EventRouter(e,t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventRouter),this.translationHandler=e,this.errorHandler=e.errorHandler;var wrap=function(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];try{return e.apply(r,n)}catch(e){var a;handleUIError(e,{type:ErrorTypes.UI,context:"event-router",eventType:null===(a=n[0])||void 0===a?void 0:a.type})}}};this.handleFocus=wrap(this.handleFocusMethod),this.handleBlur=wrap(this.handleBlurMethod),this.handleClick=wrap(this.handleClickMethod),this.handleKeyDown=wrap(this.handleKeyDownMethod),this.handleMouseOver=wrap(this.handleMouseOverMethod),this.handleMouseUp=wrap(this.handleMouseUpMethod),this.featureManager=t,this._attached=new Set,this.featureEventMap={TEXT_FIELDS:[{target:document,type:"focus",listener:this.handleFocus,options:!0},{target:document,type:"blur",listener:this.handleBlur,options:!0}],SHORTCUT_TEXT_FIELDS:[{target:document,type:"keydown",listener:this.handleKeyDown}],SELECT_ELEMENT:[{target:document,type:"mouseover",listener:this.handleMouseOver},{target:document,type:"click",listener:this.handleClick}],TEXT_SELECTION:[{target:document,type:"mouseup",listener:this.handleMouseUp}]},this.initEventListeners(),this.featureManager.on("EXTENSION_ENABLED",(function(){return r.initEventListeners()})),Object.keys(this.featureEventMap).forEach((function(e){r.featureManager.on(e,(function(){return r.updateListeners(e)}))}))},m=[{key:"initEventListeners",value:function(){var e=this,t=this.featureManager.isOn("EXTENSION_ENABLED");Object.keys(this.featureEventMap).forEach((function(r){t?e.updateListeners(r):e.removeListeners(r)}))}},{key:"updateListeners",value:function(e){var t=this,r=this.featureManager.isOn(e)&&this.featureManager.isOn("EXTENSION_ENABLED");this.featureEventMap[e].forEach((function(n){var o=n.target,a=n.type,i=n.listener,c=n.options,u="".concat(a,"_").concat(e);r&&!t._attached.has(u)?(o.addEventListener(a,i,c),t._attached.add(u)):!r&&t._attached.has(u)&&(o.removeEventListener(a,i,c),t._attached["delete"](u))}))}},{key:"removeListeners",value:function(e){var t=this;this.featureEventMap[e].forEach((function(r){var n=r.target,o=r.type,a=r.listener,i=r.options,c="".concat(o,"_").concat(e);t._attached.has(c)&&(n.removeEventListener(o,a,i),t._attached["delete"](c))}))}},{key:"handleFocusMethod",value:(I=EventRouter_asyncToGenerator(EventRouter_regeneratorRuntime().mark((function _callee(e){return EventRouter_regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:this.featureManager.isOn("TEXT_FIELDS")&&e.target.isContentEditable&&this.translationHandler.handleEditableFocus(e.target);case 1:case"end":return t.stop()}}),_callee,this)}))),function(e){return I.apply(this,arguments)})},{key:"handleBlurMethod",value:(T=EventRouter_asyncToGenerator(EventRouter_regeneratorRuntime().mark((function _callee2(e){return EventRouter_regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:this.featureManager.isOn("TEXT_FIELDS")&&e.target.isContentEditable&&this.translationHandler.handleEditableBlur(e.target);case 1:case"end":return t.stop()}}),_callee2,this)}))),function(e){return T.apply(this,arguments)})},{key:"handleClickMethod",value:(A=EventRouter_asyncToGenerator(EventRouter_regeneratorRuntime().mark((function _callee3(e){return EventRouter_regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:if(state.selectElementActive){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.translationHandler.eventHandler.handleSelect_ElementClick(e);case 4:case"end":return t.stop()}}),_callee3,this)}))),function(e){return A.apply(this,arguments)})},{key:"handleKeyDownMethod",value:(E=EventRouter_asyncToGenerator(EventRouter_regeneratorRuntime().mark((function _callee4(e){return EventRouter_regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:this.translationHandler.handleEvent(e);case 1:case"end":return t.stop()}}),_callee4,this)}))),function(e){return E.apply(this,arguments)})},{key:"handleMouseOverMethod",value:(x=EventRouter_asyncToGenerator(EventRouter_regeneratorRuntime().mark((function _callee5(e){var t,r,n,o;return EventRouter_regeneratorRuntime().wrap((function(a){for(;1;)switch(a.prev=a.next){case 0:if(state.selectElementActive){a.next=2;break}return a.abrupt("return");case 2:if(null!=(o=(null===(t=e.composedPath)||void 0===t?void 0:t.call(e)[0])||e.target)&&null!==(r=o.innerText)&&void 0!==r&&r.trim()){a.next=5;break}return a.abrupt("return");case 5:(null===(n=state.highlightedElement)||void 0===n||null===(n=n.style)||void 0===n?void 0:n.outline)&&(state.highlightedElement.style.outline=""),state.highlightedElement=o,o.style.outline=CONFIG.HIGHLIGHT_STYLE;case 8:case"end":return a.stop()}}),_callee5)}))),function(e){return x.apply(this,arguments)})},{key:"handleMouseUpMethod",value:(b=EventRouter_asyncToGenerator(EventRouter_regeneratorRuntime().mark((function _callee6(e){return EventRouter_regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:this.translationHandler.handleEvent(e);case 1:case"end":return t.stop()}}),_callee6,this)}))),function(e){return b.apply(this,arguments)})},{key:"dispose",value:(w=EventRouter_asyncToGenerator(EventRouter_regeneratorRuntime().mark((function _callee7(){var e=this;return EventRouter_regeneratorRuntime().wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:Object.keys(this.featureEventMap).forEach((function(t){return e.removeListeners(t)}));case 1:case"end":return t.stop()}}),_callee7,this)}))),function(){return w.apply(this,arguments)})}],m&&EventRouter_defineProperties(g.prototype,m),_&&EventRouter_defineProperties(g,_),Object.defineProperty(g,"prototype",{writable:!1}));function onInstalled_typeof(e){return onInstalled_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},onInstalled_typeof(e)}function onInstalled_regeneratorRuntime(){onInstalled_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var a=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(a.prototype),c=new Context(n||[]);return o(i,"_invoke",{value:makeInvokeMethod(e,r,c)}),i}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",l="suspendedYield",f="executing",h="completed",p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var y={};define(y,i,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,i)&&(y=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(r,o,a,i){var c=tryCatch(e[r],e,o);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==onInstalled_typeof(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,a,i)}),(function(e){invoke("throw",e,a,i)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return invoke("throw",e,a,i)}))}i(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function callInvokeWithMethodAndArg(){return new t((function(t,r){invoke(e,n,t,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,n){var o=s;return function(a,i){if(o===f)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===s)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var y=tryCatch(t,r,n);if("normal"===y.type){if(o=n.done?h:l,y.arg===p)continue;return{value:y.arg,done:n.done}}"throw"===y.type&&(o=h,n.method="throw",n.arg=y.arg)}}}function maybeInvokeDelegate(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(n.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}throw new TypeError(onInstalled_typeof(t)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new AsyncIterator(wrap(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,i,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function handle(n,o){return i.type="throw",i.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:values(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),p}},t}function onInstalled_createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return onInstalled_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?onInstalled_arrayLikeToArray(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,F=function(){};return{s:F,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(i)throw o}}}}function onInstalled_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function onInstalled_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function onInstalled_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?onInstalled_ownKeys(Object(r),!0).forEach((function(t){onInstalled_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):onInstalled_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function onInstalled_defineProperty(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=onInstalled_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=onInstalled_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==onInstalled_typeof(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function onInstalled_asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}var k=new n.z;r().runtime.onInstalled.addListener((function(t){var n,i;(0,e.tb)("[AI Writing Companion] ðŸŒŸ Successfully ".concat("install"===t.reason?"Installed!":"update"===t.reason?"Updated!":"")),null==n||null===(i=n.dispose)||void 0===i||i.call(n);var c=function(){var e,t=(e=onInstalled_regeneratorRuntime().mark((function _callee(){var e,t,n,i,c,u;return onInstalled_regeneratorRuntime().wrap((function(s){for(;1;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,a.M_)();case 3:return e=s.sent,t=onInstalled_objectSpread(onInstalled_objectSpread({},a.PI),e),s.next=7,r().storage.local.set(t);case 7:return s.next=9,r().tabs.query({url:"<all_urls>"});case 9:n=s.sent,i=onInstalled_createForOfIteratorHelper(n),s.prev=11,i.s();case 13:if((c=i.n()).done){s.next=26;break}if((u=c.value).id&&u.url){s.next=17;break}return s.abrupt("continue",24);case 17:return s.prev=17,s.next=20,r().runtime.sendMessage({action:"TRY_INJECT_IF_NEEDED",tabId:u.id,url:u.url});case 20:s.next=24;break;case 22:s.prev=22,s.t0=s["catch"](17);case 24:s.next=13;break;case 26:s.next=31;break;case 28:s.prev=28,s.t1=s["catch"](11),i.e(s.t1);case 31:return s.prev=31,i.f(),s.finish(31);case 34:s.next=41;break;case 36:return s.prev=36,s.t2=s["catch"](0),s.next=40,k.handle(s.t2,{type:o.w.SERVICE,context:"background-onInstalled-initOrUpdate"});case 40:throw s.sent;case 41:case"end":return s.stop()}}),_callee,null,[[0,36],[11,28,31,34],[17,22]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function _next(e){onInstalled_asyncGeneratorStep(a,n,o,_next,_throw,"next",e)}function _throw(e){onInstalled_asyncGeneratorStep(a,n,o,_next,_throw,"throw",e)}_next(void 0)}))});return function(){return t.apply(this,arguments)}}();"install"!==t.reason&&"update"!==t.reason||c().then((function(){!function(){_dismissAllSelectionWindows.apply(this,arguments)}()}))})),(0,e.tb)("[AI Writing Companion] âœ… Main script loaded, listeners attached.")})()})();